--STGAP00017201 - Release(5.0) MR-092:Update triggers to Person View

--Need to update the triggers TISU_PERSON & TISI_PERSON that are associated to the Person View


--CREATE OR REPLACE TRIGGER CAPS."TISI_PERSON" 
--INSTEAD OF INSERT
--ON CAPS.PERSON REFERENCING NEW AS NEW
--BEGIN
--INSERT INTO CAPS.PERSON_ENC (
--  ID_PERSON,
--  DT_LAST_UPDATE,
--  CD_PERSON_SEX,
--  ADDR_PERSON_ST_LN_1,
--  ADDR_PERSON_CITY,
--  ADDR_PERSON_ZIP,
--  DT_PERSON_DEATH,
--  DT_PERSON_BIRTH,
--  CD_PERSON_RELIGION,
--  CD_PERSON_CHAR,
--  CD_PERSON_LIV_ARR,
--  CD_PERS_GUARD_CNSRV,
--  CD_PERSON_STATUS,
--  CD_PERSON_DEATH,
--  CD_PERSON_MARITAL_STATUS,
--  CD_PERSON_LANGUAGE,
--  CD_PERSON_ETHNIC_GROUP,
--  CD_PERSON_STATE,
--  CD_PERSON_COUNTY,
--  IND_PERSON_DOB_APPROX,
--  IND_PERS_CANCEL_HIST,
--  NBR_PERSON_AGE,
--  NBR_PERSON_PHONE,
--  NM_PERSON_FIRST,
--  NM_PERSON_MIDDLE,
--  NM_PERSON_LAST,
--  NM_PERSON_FULL,
--  TXT_PERSON_OCCUPATION,
--  CD_PERSON_SUFFIX,
--  IND_AUTO_PERS_MERGE,
--  CD_DISASTER_RLF,
--  CD_PERSON_TITLE,
--  IND_PERSON_US_CITIZEN,
--  CD_PERSON_IMMIGRATION_STATUS,
--  CD_PERSON_COUNTRY_ORIGIN,
--  TXT_CHAR_CMNTS,
--  CD_PERS_NOT_YET_DIAG,
--  CD_PERSON_PROOF_CITIZENSHIP,
--  TXT_PERSON_OTHER_RELATIONSHIPS,
--  CD_MATCH_TYPE,
--  CD_SMILE_CLIENT,
--  TXT_IDS_NUMBER,
--  IND_PREV_ADOPTED,
--  IND_PRIVATE,
--  IND_PUBLIC,
--  IND_INTRNTL,
--  CD_ADOPT_STATE,
--  CD_ADOPT_COUNTY,
--  CD_ADOPT_CNTRY,
--  IND_ADOPT_DISLUTON,
--  TXT_PERSON_ADDL_CMNTS,
--  DT_DISSOLUTION,
--  DT_PREV_ADOPTION,
--  TXT_NAME_OF_ADO_AGENCY,
--  IND_ADOPT_FINALIZED,
--  IND_ADOPT_AFCARS_SENT,
--  IND_ADOPTED,
--  IND_SINGLE_PAR_ADOPT,
--  CD_SINGLE_MOTHER_FATHER,
--  IND_IVE_PRIOR_ADOPTION,
--  NBR_PERSON_ID_NUMBER)
--VALUES
--(
--:NEW.ID_PERSON,
--:NEW.DT_LAST_UPDATE,
--:NEW.CD_PERSON_SEX,
--:NEW.ADDR_PERSON_ST_LN_1,
--:NEW.ADDR_PERSON_CITY,
--:NEW.ADDR_PERSON_ZIP,
--:NEW.DT_PERSON_DEATH,
--:NEW.DT_PERSON_BIRTH,
--:NEW.CD_PERSON_RELIGION,
--:NEW.CD_PERSON_CHAR,
--:NEW.CD_PERSON_LIV_ARR,
--:NEW.CD_PERS_GUARD_CNSRV,
--:NEW.CD_PERSON_STATUS,
--:NEW.CD_PERSON_DEATH,
--:NEW.CD_PERSON_MARITAL_STATUS,
--:NEW.CD_PERSON_LANGUAGE,
--:NEW.CD_PERSON_ETHNIC_GROUP,
--:NEW.CD_PERSON_STATE,
--:NEW.CD_PERSON_COUNTY,
--:NEW.IND_PERSON_DOB_APPROX,
--:NEW.IND_PERS_CANCEL_HIST,
--:NEW.NBR_PERSON_AGE,
--:NEW.NBR_PERSON_PHONE,
--:NEW.NM_PERSON_FIRST,
--:NEW.NM_PERSON_MIDDLE,
--:NEW.NM_PERSON_LAST,
--:NEW.NM_PERSON_FULL,
--:NEW.TXT_PERSON_OCCUPATION,
--:NEW.CD_PERSON_SUFFIX,
--:NEW.IND_AUTO_PERS_MERGE,
--:NEW.CD_DISASTER_RLF,
--:NEW.CD_PERSON_TITLE,
--:NEW.IND_PERSON_US_CITIZEN,
--:NEW.CD_PERSON_IMMIGRATION_STATUS,
--:NEW.CD_PERSON_COUNTRY_ORIGIN,
--:NEW.TXT_CHAR_CMNTS,
--:NEW.CD_PERS_NOT_YET_DIAG,
--:NEW.CD_PERSON_PROOF_CITIZENSHIP,
--:NEW.TXT_PERSON_OTHER_RELATIONSHIPS,
--:NEW.CD_MATCH_TYPE,
--:NEW.CD_SMILE_CLIENT,
--:NEW.TXT_IDS_NUMBER,
--:NEW.IND_PREV_ADOPTED,
--:NEW.IND_PRIVATE,
--:NEW.IND_PUBLIC,
--:NEW.IND_INTRNTL,
--:NEW.CD_ADOPT_STATE,
--:NEW.CD_ADOPT_COUNTY,
--:NEW.CD_ADOPT_CNTRY,
--:NEW.IND_ADOPT_DISLUTON,
--:NEW.TXT_PERSON_ADDL_CMNTS,
--:NEW.DT_DISSOLUTION,
--:NEW.DT_PREV_ADOPTION,
--:NEW.TXT_NAME_OF_ADO_AGENCY,
--:NEW.IND_ADOPT_FINALIZED,
--:NEW.IND_ADOPT_AFCARS_SENT,
--:NEW.IND_ADOPTED,
--:NEW.IND_SINGLE_PAR_ADOPT,
--:NEW.CD_SINGLE_MOTHER_FATHER,
--:NEW.IND_IVE_PRIOR_ADOPTION,
--ENCRYPT(:NEW.NBR_PERSON_ID_NUMBER) ) ;
--END;


--CREATE OR REPLACE TRIGGER CAPS."TISU_PERSON" 
--INSTEAD OF UPDATE
--ON CAPS.PERSON REFERENCING NEW AS NEW OLD AS OLD
--BEGIN
--UPDATE CAPS.PERSON_ENC SET
--  CD_PERSON_SEX = :NEW.CD_PERSON_SEX,
--  ADDR_PERSON_ST_LN_1 = :NEW.ADDR_PERSON_ST_LN_1,
--  ADDR_PERSON_CITY = :NEW.ADDR_PERSON_CITY,
--  ADDR_PERSON_ZIP = :NEW.ADDR_PERSON_ZIP,
--  DT_PERSON_DEATH = :NEW.DT_PERSON_DEATH,
--  DT_PERSON_BIRTH = :NEW.DT_PERSON_BIRTH,
--  CD_PERSON_RELIGION = :NEW.CD_PERSON_RELIGION,
--  CD_PERSON_CHAR = :NEW.CD_PERSON_CHAR,
--  CD_PERSON_LIV_ARR = :NEW.CD_PERSON_LIV_ARR,
--  CD_PERS_GUARD_CNSRV = :NEW.CD_PERS_GUARD_CNSRV,
--  CD_PERSON_STATUS = :NEW.CD_PERSON_STATUS,
--  CD_PERSON_DEATH = :NEW.CD_PERSON_DEATH,
--  CD_PERSON_MARITAL_STATUS = :NEW.CD_PERSON_MARITAL_STATUS,
--  CD_PERSON_LANGUAGE = :NEW.CD_PERSON_LANGUAGE,
--  CD_PERSON_ETHNIC_GROUP = :NEW.CD_PERSON_ETHNIC_GROUP,
--  CD_PERSON_STATE = :NEW.CD_PERSON_STATE,
--  CD_PERSON_COUNTY = :NEW.CD_PERSON_COUNTY,
--  IND_PERSON_DOB_APPROX = :NEW.IND_PERSON_DOB_APPROX,
--  IND_PERS_CANCEL_HIST = :NEW.IND_PERS_CANCEL_HIST,
--  NBR_PERSON_AGE = :NEW.NBR_PERSON_AGE,
--  NBR_PERSON_PHONE = :NEW.NBR_PERSON_PHONE,
--  NM_PERSON_FIRST = :NEW.NM_PERSON_FIRST,
--  NM_PERSON_MIDDLE = :NEW.NM_PERSON_MIDDLE,
--  NM_PERSON_LAST = :NEW.NM_PERSON_LAST,
--  NM_PERSON_FULL = :NEW.NM_PERSON_FULL,
--  TXT_PERSON_OCCUPATION = :NEW.TXT_PERSON_OCCUPATION,
--  CD_PERSON_SUFFIX = :NEW.CD_PERSON_SUFFIX,
--  IND_AUTO_PERS_MERGE = :NEW.IND_AUTO_PERS_MERGE,
--  CD_DISASTER_RLF = :NEW.CD_DISASTER_RLF,
--  CD_PERSON_TITLE = :NEW.CD_PERSON_TITLE,
--  IND_PERSON_US_CITIZEN = :NEW.IND_PERSON_US_CITIZEN,
--  CD_PERSON_IMMIGRATION_STATUS = :NEW.CD_PERSON_IMMIGRATION_STATUS,
--  CD_PERSON_COUNTRY_ORIGIN = :NEW.CD_PERSON_COUNTRY_ORIGIN,
--  TXT_CHAR_CMNTS = :NEW.TXT_CHAR_CMNTS,
--  CD_PERS_NOT_YET_DIAG = :NEW.CD_PERS_NOT_YET_DIAG,
--  CD_PERSON_PROOF_CITIZENSHIP = :NEW.CD_PERSON_PROOF_CITIZENSHIP,
--  TXT_PERSON_OTHER_RELATIONSHIPS = :NEW.TXT_PERSON_OTHER_RELATIONSHIPS,
--  CD_MATCH_TYPE = :NEW.CD_MATCH_TYPE,
--  CD_SMILE_CLIENT = :NEW.CD_SMILE_CLIENT,
--  TXT_IDS_NUMBER = :NEW.TXT_IDS_NUMBER,
--  IND_PREV_ADOPTED = :NEW.IND_PREV_ADOPTED,
--  IND_PRIVATE = :NEW.IND_PRIVATE,
--  IND_PUBLIC = :NEW.IND_PUBLIC,
--  IND_INTRNTL = :NEW.IND_INTRNTL,
--  CD_ADOPT_STATE = :NEW.CD_ADOPT_STATE,
--  CD_ADOPT_COUNTY = :NEW.CD_ADOPT_COUNTY,
--  CD_ADOPT_CNTRY = :NEW.CD_ADOPT_CNTRY,
--  IND_ADOPT_DISLUTON = :NEW.IND_ADOPT_DISLUTON,
--  TXT_PERSON_ADDL_CMNTS = :NEW.TXT_PERSON_ADDL_CMNTS,
--  DT_DISSOLUTION=:NEW.DT_DISSOLUTION,
--  DT_PREV_ADOPTION=:NEW.DT_PREV_ADOPTION,
--  TXT_NAME_OF_ADO_AGENCY=:NEW.TXT_NAME_OF_ADO_AGENCY,
--  IND_ADOPT_FINALIZED=:NEW.IND_ADOPT_FINALIZED,
--  IND_ADOPT_AFCARS_SENT=:NEW.IND_ADOPT_AFCARS_SENT,
--  IND_ADOPTED=:NEW.IND_ADOPTED,
--  IND_SINGLE_PAR_ADOPT=:NEW.IND_SINGLE_PAR_ADOPT,
--  CD_SINGLE_MOTHER_FATHER=:NEW.CD_SINGLE_MOTHER_FATHER,
--  IND_IVE_PRIOR_ADOPTION=:NEW.IND_IVE_PRIOR_ADOPTION,
--  NBR_PERSON_ID_NUMBER = CAPS.ENCRYPT(:NEW.NBR_PERSON_ID_NUMBER)
--WHERE ID_PERSON = :OLD.ID_PERSON;
--END;


insert into caps.schema_version(id_schema_version,application_version,comments)
            values (1137, 'SacwisRev5', 'Release 5.0 - DBCR 17201');

commit;
