!---------------------------------------------------------------------------------------------------------
! Generated on Fri Sep 23 14:42:41 2011 by Hyperion SQR Developer 8.5.0.0.0.302
! Filename: C:\Documents and Settings\tabailey\My Documents\Shines Reports\Reports 2011\Resources\DFCS Home Development\DFCSDevelopment00.sqr
! Format  : Tabular
! Username: TBAILEY
!---------------------------------------------------------------------------------------------------------

Begin-Setup
 Declare-Layout Default
  Orientation = Landscape
  Paper-Size = (Letter)
  Top-Margin    = 0.500 
  Bottom-Margin = 0.500 
  Left-Margin   = 0.100 
  Right-Margin  = 0.100 
  Line-Height = 1
  Char-Width  = 1
 End-Declare
 Declare-Procedure
  Before-Report = BRB_Report_Before
  After-Report = BRB_Report_After
  After-Page = BRB_After_Page
 End-Declare
DECLARE-VARIABLE
 Text $StartDate 
END-DECLARE
End-Setup

Begin-Procedure BRB_Report_Before
 Alter-Report Heading-Size=144    ! combined report header - page header data
 Next-Listing
End-Procedure

Begin-Procedure BRB_Report_After
 Alter-Report Heading=None Footing=None
 New-Page
 Position (1,1)
 Alter-Printer Font=4 Point-Size=10    ! [SQR.INI] 4=Arial,proportional
 Print 'Definition' (12,1,12) Underline  Bold 
 Print 'Calls for Inquiry:' (77,1,34) Bold 
 Print 'Homes Attended Orientation:' (98,1,39) Bold 
 Print 'Homes that Attended Pre-Service Training:' (141,1,46) Bold 
 Print 'Homes Approved - Full:' (163,1,54) Bold 
 Print 'Homes Approved - Special:' (184,1,25) Bold 
 Print '# of Beds:' (251,1,24) Bold  Wrap 24 2 line-height=12 Keep-Top on= 
 Print 'Homes Waitlisted:' (311,1,19) Bold 
 Print 'Home Closures:' (333,1,15) Bold 
 Print 'Number of homes placed in Closed status at any point during the reporting period.' (333,209,166)
 Print 'Number of homes placed in Waitlisted status at any point during the reporting period.' (311,209,128)
 Print 'Number of beds (capacity) available for homes placed in Approved - Full, Approved - Special, Full and Special Approval 30 Day' (251,209,158)
 Print 'Number of homes placed in Approved - Special status at any point during the reporting period.' (184,209,122)
 Print 'Number of homes placed in Approved - Full status at any point during the reporting period.' (163,209,129) Wrap 129 2 line-height=12 Keep-Top on= 
 Print 'Number of new inquiries received during the reporting period' (79,209,79)
 Print 'Number of homes that attended Orientation during the reporting period.' (98,209,132)
 Print 'Number of homes that attended Pre-Service training during the reporting period.' (141,209,120)
 Print 'Number of homes placed in Applicant (Pre-Service training) status at any point during the reporting period.' (119,209,123)
 Print 'The DFCS Homes Development Report displays the numbers for Foster, Foster/Adopt(Legal Risk), Adoption, Relative Adopt, Relative Foster, ICPC Adopt and ICPC Foster ' (28,1,195)
 Page-Number (431,661) '' ' of'
 Last-Page (431,690) 
 Print 'Grace status during the reporting period.' (267,209,93)
 Print 'Homes in Applicant Pre-Service Training:' (119,1,51) Bold 
 Print 'Full Approval 30 Day Grace:' (205,1,31) Bold 
 Print 'Special Approval 30 Day Grace:' (228,1,33) Bold 
 Print 'Number of homes placed in Full Approval 30 Day Grace status at any point during the reporting period.' (205,208,143)
 Print 'Number of homes placed in Special Approval 30 Day Grace status at any point during the reporting period.' (228,208,133)
 Print 'Homes Unapproved:' (289,1,19) Bold 
 Print 'Number of homes placed in Unapproved status at any point during the reporting period.' (289,209,129)
 Print 'homes for the reporting period.' (43,1,47)
   Print-Direct printer=html '%%ResetBorder'
 Alter-Report Heading=Default
              Footing=Default
 Next-Listing
End-Procedure

! Supports a special heading on the first page, which combines the report
! header and the default page header into a single header only for that page,
! changing it back to the default page header for subsequent pages.
Begin-Procedure BRB_After_Page
 If #page-count <= 1
   Alter-Report Heading-Size=24   ! Revert to non-page-1 header size.
 End-If
End-Procedure

Begin-Program
Do Get-Date-Range
Do Get_Region_County

 Position (1,1)
Do Get-Inquiry
Do Attend_Orientation
Do Pre_Service_Train
Do Attend_Training
Do Home-Approval
Do Home-Capacity
Do Waitlist-Homes
DO Unapproved-Homes
DO Closed-Homes
Do FH-Closed
 Do Master_Query
 Do Master_Query_5
 Do Master_Query_2
 Do Master_Query_6
 Do Master_Query_3
 Do Master_Query_7
 Do Master_Query_4
 Do Master_Query_9
 Do Master_Query_8
 Do Master_Query_11
 Do Master_Query_10
 Do Master_Query_13
 Do Master_Query_12
 Do Master_Query_15
 Do Master_Query_14
End-Program
Begin-Procedure Get-Date-Range
Input $_StartDate 'Enter Start Date (MM/DD/YYYY)' MaxLen=19 Type=Date Format='MM/DD/YYYY'
Input $_EndDate 'Enter End Date (MM/DD/YYYY)' MaxLen=19 Type=Date Format='MM/DD/YYYY'
End-Procedure

! -----------------------------
! Get Region and County Optional Parameters
Begin-Procedure Get_Region_County
! Get region optional input
Input $_I201_CD_RSHS_REGION 'Enter a value for CD_RSHS_REGION' MaxLen=2  Type=Char
If IsNull($_I201_CD_RSHS_REGION) or IsBlank($_I201_CD_RSHS_REGION) or ($_I201_CD_RSHS_REGION='0')
  Let $where_clause_region_hist = 'CD_RSHS_REGION is not null'
  Let $where_clause_region_resc = 'CD_RSRC_REGION is not null'
  Let $regionSelected = 'N'
Else 
  Let $where_clause_region_hist = 'CD_RSHS_REGION = ' || '''' || $_I201_CD_RSHS_REGION || ''''
  Let $where_clause_region_resc = 'CD_RSRC_REGION = ' || '''' || $_I201_CD_RSHS_REGION || ''''
  Let $regionSelected = 'Y'
End-If
!------------
! Get county optional input
Input $_I202_CD_RSHS_CNTY 'Enter a value for CD_RSHS_CNTY' MaxLen=3  Type=Char
If IsNull($_I202_CD_RSHS_CNTY) or IsBlank($_I202_CD_RSHS_CNTY) or ($_I202_CD_RSHS_CNTY='0')
  Let $where_clause_county_hist = 'CD_RSHS_CNTY IS NOT NULL'
  Let $where_clause_county_resc = 'CD_RSRC_CNTY is not null'
  Let $countySelected = 'N'
Else 
  Let $where_clause_county_hist = 'CD_RSHS_CNTY = ' || '''' || $_I202_CD_RSHS_CNTY|| ''''
  Let $where_clause_county_resc = 'CD_RSRC_CNTY = ' || '''' || $_I202_CD_RSHS_CNTY|| ''''
  Let $countySelected = 'Y'
End-If
! Create where clause for region, county and unit input
Let $_where_clause_region_county_hist = $where_clause_region_hist || ' and ' || $where_clause_county_hist 
Let $_where_clause_region_county_resc = $where_clause_region_resc || ' and ' || $where_clause_county_resc 

Do Make_Header
End-Procedure
!-----------
!Make Region County Header
Begin-Procedure Make_Header
Let $region_header =''
If $countySelected = 'Y'
  Let $county_code_string = '''' || $_I202_CD_RSHS_CNTY || ''''
Begin-Select
decode &county_decode_header
 Move &county_decode_header to $region_county_header
from ccount
where code = [$county_code_string]
End-Select
  If $_I202_CD_RSHS_CNTY = 'XXX' and $regionSelected = 'Y'
    Let $region_county_header = 'County ' || $region_county_header
    Let $region_header = 'Region ' || $_I201_CD_RSHS_REGION
  End-If
Else 
 If $regionSelected = 'Y'
  Let $region_county_header = 'Region ' || $_I201_CD_RSHS_REGION
 Else
  Let $region_county_header = 'Statewide' 
 End-If
End-If
 ! Fill spaces in front of the county name/region number/statewide to make it centered on page
 ! Currently the longest county name in GA is 13
 Let #cnty_name_len = length($region_county_header)
 Let #spaces = (13 - #cnty_name_len) ! No need to divide by 2 b/c space is non-character and observation shows that compiler won't make it bold, therefore taking about half of the pixels needed
 Let #counter = 0
 While #counter < #spaces
   Let $region_county_header = ' ' || $region_county_header 
   Let #counter = #counter + 1
 End-while
End-Procedure


Begin-Procedure Get-Inquiry
Begin-Select distinct
count(distinct resource_history.ID_RESOURCE) &_inq_foster_disp
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE <to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'INQ'
AND resource_history.CD_RSHS_CATEGORY = 'F'
AND resource_history.IND_RSRC_NONDFCS = 'N'
and [$_where_clause_region_county_hist]
End-Select
move &_inq_foster_disp to #fostercount

Begin-Select distinct
count(distinct resource_history.ID_RESOURCE) &_inq_legal_disp
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'INQ'
AND resource_history.CD_RSHS_CATEGORY = 'L'
AND resource_history.IND_RSRC_NONDFCS = 'N'
and [$_where_clause_region_county_hist]
End-Select

!Inquiry Status doe Adoption
Begin-Select distinct
count(distinct resource_history.ID_RESOURCE) &_inq_adop_disp
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'INQ'
AND resource_history.CD_RSHS_CATEGORY = 'A'
AND resource_history.IND_RSRC_NONDFCS = 'N'
and [$_where_clause_region_county_hist]
End-Select

!Inquiry Status for Relative Adopt
Begin-Select distinct
count(distinct resource_history.ID_RESOURCE) &_inq_Relative_adopt_disp
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'INQ'
AND resource_history.CD_RSHS_CATEGORY = 'D'
AND resource_history.IND_RSRC_NONDFCS = 'N'
and [$_where_clause_region_county_hist]
End-Select

!Inquiry Status for Relative Foster
Begin-Select distinct
count(distinct resource_history.ID_RESOURCE) &_inq_Relative_Foster_disp
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'INQ'
AND resource_history.CD_RSHS_CATEGORY = 'O'
AND resource_history.IND_RSRC_NONDFCS = 'N'
and [$_where_clause_region_county_hist]
End-Select

!Inquiry Status for ICPC Adopt
Begin-Select distinct
count(distinct resource_history.ID_RESOURCE) &_inq_ICPC_Adopt_disp
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'INQ'
AND resource_history.CD_RSHS_CATEGORY = 'J'
AND resource_history.IND_RSRC_NONDFCS = 'N'
and [$_where_clause_region_county_hist]
End-Select

!Inquiry Status for ICPC Foster
Begin-Select distinct
count(distinct resource_history.ID_RESOURCE) &_inq_ICPC_Foster_disp
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'INQ'
AND resource_history.CD_RSHS_CATEGORY = 'I'
AND resource_history.IND_RSRC_NONDFCS = 'N'
and [$_where_clause_region_county_hist]
End-Select
End-Procedure


! Attended Orientation
Begin-Procedure Attend_Orientation
! Attended Orientation for Foster
Begin-Select DISTINCT 
count (caps_resource.ID_RESOURCE) &_att_orient_foster
FROM caps_resource
WHERE caps_resource.CD_RSRC_CATEGORY = 'F' !change to L and A as appropriate for Legal Risk and Adoptive homes
and caps_resource.IND_RSRC_NONDFCS = 'N'
and [$_where_clause_region_county_resc]
and exists ( select *
             from HOME_APPLICANT_INFO
             where caps_resource.ID_RESOURCE = HOME_APPLICANT_INFO.ID_RESOURCE !join to outer query
             and (
                   (HOME_APPLICANT_INFO.DT_ORIENT1 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
                   and HOME_APPLICANT_INFO.DT_ORIENT1 >= to_date($_StartDate,'MM/DD/YYYY')  ! first day of reporting period
                   and HOME_APPLICANT_INFO.CD_ORIENT1_STAT = 'ATT' ! means the status was Attended
                   ) 
                   OR 
                   (HOME_APPLICANT_INFO.DT_ORIENT2 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
                   and HOME_APPLICANT_INFO.DT_ORIENT2 >= to_date($_StartDate,'MM/DD/YYYY')  ! first day of reporting period
                   and HOME_APPLICANT_INFO.CD_ORIENT2_STAT = 'ATT' ! means the status was Attended
                   ) 
                   OR 
                   (HOME_APPLICANT_INFO.DT_ORIENT3 < to_date($_EndDate, 'MM/DD/YYYY') + 1! last day of reporting period
                   and HOME_APPLICANT_INFO.DT_ORIENT3 >= to_date($_StartDate,'MM/DD/YYYY')  ! first day of reporting period
                   and HOME_APPLICANT_INFO.CD_ORIENT3_STAT = 'ATT' ! means the status was Attended
                   )  
                )           
         )
End-Select

! Attended Orientation for Legal Risk
Begin-Select DISTINCT 
count (caps_resource.ID_RESOURCE) &_att_orient_legal
FROM caps_resource
WHERE caps_resource.CD_RSRC_CATEGORY = 'L' !L for Legal Risk homes
and caps_resource.IND_RSRC_NONDFCS = 'N'
and [$_where_clause_region_county_resc]
and exists ( select *
             from HOME_APPLICANT_INFO
             where caps_resource.ID_RESOURCE = HOME_APPLICANT_INFO.ID_RESOURCE !join to outer query
             and (
                   (HOME_APPLICANT_INFO.DT_ORIENT1 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
                   and HOME_APPLICANT_INFO.DT_ORIENT1 >= to_date($_StartDate,'MM/DD/YYYY')  ! first day of reporting period
                   and HOME_APPLICANT_INFO.CD_ORIENT1_STAT = 'ATT' ! means the status was Attended
                   ) 
                   OR 
                   (HOME_APPLICANT_INFO.DT_ORIENT2 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
                   and HOME_APPLICANT_INFO.DT_ORIENT2 >= to_date($_StartDate,'MM/DD/YYYY')  ! first day of reporting period
                   and HOME_APPLICANT_INFO.CD_ORIENT2_STAT = 'ATT' ! means the status was Attended
                   ) 
                   OR 
                   (HOME_APPLICANT_INFO.DT_ORIENT3 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
                   and HOME_APPLICANT_INFO.DT_ORIENT3 >= to_date($_StartDate,'MM/DD/YYYY') ! first day of reporting period
                   and HOME_APPLICANT_INFO.CD_ORIENT3_STAT = 'ATT' ! means the status was Attended
                   )  
                )           
         )
End-Select

! Attended Orientation for Adoptive Homes
Begin-Select DISTINCT 
count (caps_resource.ID_RESOURCE) &_att_orient_adopt
FROM caps_resource
WHERE caps_resource.CD_RSRC_CATEGORY = 'A' ! A for Adoptive homes
and caps_resource.IND_RSRC_NONDFCS = 'N'
and [$_where_clause_region_county_resc]
and exists ( select *
             from HOME_APPLICANT_INFO
             where caps_resource.ID_RESOURCE = HOME_APPLICANT_INFO.ID_RESOURCE !join to outer query
             and (
                   (HOME_APPLICANT_INFO.DT_ORIENT1 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
                   and HOME_APPLICANT_INFO.DT_ORIENT1 >= to_date($_StartDate,'MM/DD/YYYY')  ! first day of reporting period
                   and HOME_APPLICANT_INFO.CD_ORIENT1_STAT = 'ATT' ! means the status was Attended
                   ) 
                   OR 
                   (HOME_APPLICANT_INFO.DT_ORIENT2 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
                   and HOME_APPLICANT_INFO.DT_ORIENT2 >= to_date($_StartDate,'MM/DD/YYYY')  ! first day of reporting period
                   and HOME_APPLICANT_INFO.CD_ORIENT2_STAT = 'ATT' ! means the status was Attended
                   ) 
                   OR 
                   (HOME_APPLICANT_INFO.DT_ORIENT3 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
                   and HOME_APPLICANT_INFO.DT_ORIENT3 >= to_date($_StartDate,'MM/DD/YYYY')  ! first day of reporting period
                   and HOME_APPLICANT_INFO.CD_ORIENT3_STAT = 'ATT' ! means the status was Attended
                   )  
                )           
         )
End-Select

Begin-Select DISTINCT 
count (caps_resource.ID_RESOURCE) &_att_orient_Relative_adopt
FROM caps_resource
WHERE caps_resource.CD_RSRC_CATEGORY = 'D' ! D for Relative Adoptive homes
and caps_resource.IND_RSRC_NONDFCS = 'N'
and [$_where_clause_region_county_resc]
and exists ( select *
             from HOME_APPLICANT_INFO
             where caps_resource.ID_RESOURCE = HOME_APPLICANT_INFO.ID_RESOURCE !join to outer query
             and (
                   (HOME_APPLICANT_INFO.DT_ORIENT1 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
                   and HOME_APPLICANT_INFO.DT_ORIENT1 >= to_date($_StartDate,'MM/DD/YYYY')  ! first day of reporting period
                   and HOME_APPLICANT_INFO.CD_ORIENT1_STAT = 'ATT' ! means the status was Attended
                   ) 
                   OR 
                   (HOME_APPLICANT_INFO.DT_ORIENT2 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
                   and HOME_APPLICANT_INFO.DT_ORIENT2 >= to_date($_StartDate,'MM/DD/YYYY')  ! first day of reporting period
                   and HOME_APPLICANT_INFO.CD_ORIENT2_STAT = 'ATT' ! means the status was Attended
                   ) 
                   OR 
                   (HOME_APPLICANT_INFO.DT_ORIENT3 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
                   and HOME_APPLICANT_INFO.DT_ORIENT3 >= to_date($_StartDate,'MM/DD/YYYY')  ! first day of reporting period
                   and HOME_APPLICANT_INFO.CD_ORIENT3_STAT = 'ATT' ! means the status was Attended
                   )  
                )           
         )
End-Select

Begin-Select DISTINCT 
count (caps_resource.ID_RESOURCE) &_att_orient_Relative_foster
FROM caps_resource
WHERE caps_resource.CD_RSRC_CATEGORY = 'O' ! O for Relative Foster homes
and caps_resource.IND_RSRC_NONDFCS = 'N'
and [$_where_clause_region_county_resc]
and exists ( select *
             from HOME_APPLICANT_INFO
             where caps_resource.ID_RESOURCE = HOME_APPLICANT_INFO.ID_RESOURCE !join to outer query
             and (
                   (HOME_APPLICANT_INFO.DT_ORIENT1 < to_date($_EndDate, 'MM/DD/YYYY') + 1! last day of reporting period
                   and HOME_APPLICANT_INFO.DT_ORIENT1 >= to_date($_StartDate,'MM/DD/YYYY')  ! first day of reporting period
                   and HOME_APPLICANT_INFO.CD_ORIENT1_STAT = 'ATT' ! means the status was Attended
                   ) 
                   OR 
                   (HOME_APPLICANT_INFO.DT_ORIENT2 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
                   and HOME_APPLICANT_INFO.DT_ORIENT2 >= to_date($_StartDate,'MM/DD/YYYY')  ! first day of reporting period
                   and HOME_APPLICANT_INFO.CD_ORIENT2_STAT = 'ATT' ! means the status was Attended
                   ) 
                   OR 
                   (HOME_APPLICANT_INFO.DT_ORIENT3 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
                   and HOME_APPLICANT_INFO.DT_ORIENT3 >= to_date($_StartDate,'MM/DD/YYYY')  ! first day of reporting period
                   and HOME_APPLICANT_INFO.CD_ORIENT3_STAT = 'ATT' ! means the status was Attended
                   )  
                )           
         )
End-Select

Begin-Select DISTINCT 
count (caps_resource.ID_RESOURCE) &_att_orient_ICPC_adopt
FROM caps_resource
WHERE caps_resource.CD_RSRC_CATEGORY = 'J' ! J for ICPC Adoptive homes
and caps_resource.IND_RSRC_NONDFCS = 'N'
and [$_where_clause_region_county_resc]
and exists ( select *
             from HOME_APPLICANT_INFO
             where caps_resource.ID_RESOURCE = HOME_APPLICANT_INFO.ID_RESOURCE !join to outer query
             and (
                   (HOME_APPLICANT_INFO.DT_ORIENT1 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
                   and HOME_APPLICANT_INFO.DT_ORIENT1 >= to_date($_StartDate,'MM/DD/YYYY')  ! first day of reporting period
                   and HOME_APPLICANT_INFO.CD_ORIENT1_STAT = 'ATT' ! means the status was Attended
                   ) 
                   OR 
                   (HOME_APPLICANT_INFO.DT_ORIENT2 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
                   and HOME_APPLICANT_INFO.DT_ORIENT2 >= to_date($_StartDate,'MM/DD/YYYY')  ! first day of reporting period
                   and HOME_APPLICANT_INFO.CD_ORIENT2_STAT = 'ATT' ! means the status was Attended
                   ) 
                   OR 
                   (HOME_APPLICANT_INFO.DT_ORIENT3 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
                   and HOME_APPLICANT_INFO.DT_ORIENT3 >= to_date($_StartDate,'MM/DD/YYYY')  ! first day of reporting period
                   and HOME_APPLICANT_INFO.CD_ORIENT3_STAT = 'ATT' ! means the status was Attended
                   )  
                )           
         )
End-Select

Begin-Select DISTINCT 
count (caps_resource.ID_RESOURCE) &_att_orient_ICPC_foster
FROM caps_resource
WHERE caps_resource.CD_RSRC_CATEGORY = 'I' ! I for ICPC Foster homes
and caps_resource.IND_RSRC_NONDFCS = 'N'
and [$_where_clause_region_county_resc]
and exists ( select *
             from HOME_APPLICANT_INFO
             where caps_resource.ID_RESOURCE = HOME_APPLICANT_INFO.ID_RESOURCE !join to outer query
             and (
                   (HOME_APPLICANT_INFO.DT_ORIENT1 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
                   and HOME_APPLICANT_INFO.DT_ORIENT1 >= to_date($_StartDate,'MM/DD/YYYY')  ! first day of reporting period
                   and HOME_APPLICANT_INFO.CD_ORIENT1_STAT = 'ATT' ! means the status was Attended
                   ) 
                   OR 
                   (HOME_APPLICANT_INFO.DT_ORIENT2 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
                   and HOME_APPLICANT_INFO.DT_ORIENT2 >= to_date($_StartDate,'MM/DD/YYYY')  ! first day of reporting period
                   and HOME_APPLICANT_INFO.CD_ORIENT2_STAT = 'ATT' ! means the status was Attended
                   ) 
                   OR 
                   (HOME_APPLICANT_INFO.DT_ORIENT3 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
                   and HOME_APPLICANT_INFO.DT_ORIENT3 >= to_date($_StartDate,'MM/DD/YYYY')  ! first day of reporting period
                   and HOME_APPLICANT_INFO.CD_ORIENT3_STAT = 'ATT' ! means the status was Attended
                   )  
                )           
         )
End-Select
End-Procedure

Begin-Procedure Pre_Service_Train
!Training for Foster
Begin-Select distinct
count(distinct resource_history.ID_RESOURCE) &_train_foster_disp
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')  !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'APP'
AND resource_history.CD_RSHS_CATEGORY = 'F'
AND resource_history.IND_RSRC_NONDFCS = 'N'
and [$_where_clause_region_county_hist]
End-Select
!Training for Legal Risk
Begin-Select distinct
count(distinct resource_history.ID_RESOURCE)  &_train_legal_disp
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')  !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'APP'
AND resource_history.CD_RSHS_CATEGORY = 'L'
AND resource_history.IND_RSRC_NONDFCS = 'N'
and [$_where_clause_region_county_hist]
End-Select
! Training for Adoption
Begin-Select distinct
count(distinct resource_history.ID_RESOURCE) &_train_adopt_disp
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')  !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'APP'
AND resource_history.CD_RSHS_CATEGORY = 'A'
AND resource_history.IND_RSRC_NONDFCS = 'N'
and [$_where_clause_region_county_hist]
End-Select

!Training for Relative Adopt
Begin-Select distinct
count(distinct resource_history.ID_RESOURCE) &_train_relative_adopt_disp
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')  !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'APP'
AND resource_history.CD_RSHS_CATEGORY = 'D'
AND resource_history.IND_RSRC_NONDFCS = 'N'
and [$_where_clause_region_county_hist]
End-Select

!Training for Relative Foster
Begin-Select distinct
count(distinct resource_history.ID_RESOURCE) &_train_relative_foster_disp
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')  !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1!last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'APP'
AND resource_history.CD_RSHS_CATEGORY = 'O'
AND resource_history.IND_RSRC_NONDFCS = 'N'
and [$_where_clause_region_county_hist]
End-Select

!Training for ICPC Adopt
Begin-Select distinct
count(distinct resource_history.ID_RESOURCE) &_train_ICPC_adopt_disp
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')  !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'APP'
AND resource_history.CD_RSHS_CATEGORY = 'J'
AND resource_history.IND_RSRC_NONDFCS = 'N'
and [$_where_clause_region_county_hist]
End-Select

!Training for ICPC Foster
Begin-Select distinct
count(distinct resource_history.ID_RESOURCE) &_train_ICPC_foster_disp
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'APP'
AND resource_history.CD_RSHS_CATEGORY = 'I'
AND resource_history.IND_RSRC_NONDFCS = 'N'
and [$_where_clause_region_county_hist]
End-Select
End-Procedure

Begin-Procedure Attend_Training
Begin-SELECT DISTINCT 
count (distinct caps_resource.ID_RESOURCE) &_attend_train_foster
FROM caps_resource
WHERE caps_resource.CD_RSRC_CATEGORY = 'F' !F for Foster homes
and caps_resource.IND_RSRC_NONDFCS = 'N'
and [$_where_clause_region_county_resc]
and exists 
( select *
  from HOME_APPLICANT_INFO
  where caps_resource.ID_RESOURCE = HOME_APPLICANT_INFO.ID_RESOURCE !join to outer query
  and (
       (HOME_APPLICANT_INFO.DT_INVITE1 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
        and HOME_APPLICANT_INFO.DT_INVITE1  >= to_date($_StartDate,'MM/DD/YYYY') ! first day of reporting period
        and HOME_APPLICANT_INFO.CD_INVITE1_STAT = 'ATT' ! means the status was Attended
       ) 
       OR 
       (HOME_APPLICANT_INFO.DT_INVITE2 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
        and HOME_APPLICANT_INFO.DT_INVITE2  >= to_date($_StartDate,'MM/DD/YYYY') ! first day of reporting period
        and HOME_APPLICANT_INFO.CD_INVITE2_STAT = 'ATT' ! means the status was Attended
       ) 
       OR 
       (HOME_APPLICANT_INFO.DT_INVITE3 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
        and HOME_APPLICANT_INFO.DT_INVITE3  >= to_date($_StartDate,'MM/DD/YYYY')  ! first day of reporting period
        and HOME_APPLICANT_INFO.CD_INVITE3_STAT = 'ATT' ! means the status was Attended
       )  
      )           
)
End-Select

Begin-SELECT DISTINCT 
count (distinct caps_resource.ID_RESOURCE) &_attend_train_legal
FROM caps_resource
WHERE caps_resource.CD_RSRC_CATEGORY = 'L' !L for Legal Risk homes
and caps_resource.IND_RSRC_NONDFCS = 'N'
and [$_where_clause_region_county_resc]
and exists 
( select *
  from HOME_APPLICANT_INFO
  where caps_resource.ID_RESOURCE = HOME_APPLICANT_INFO.ID_RESOURCE !join to outer query
  and (
       (HOME_APPLICANT_INFO.DT_INVITE1 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
        and HOME_APPLICANT_INFO.DT_INVITE1  >= to_date($_StartDate,'MM/DD/YYYY')  ! first day of reporting period
        and HOME_APPLICANT_INFO.CD_INVITE1_STAT = 'ATT' ! means the status was Attended
       ) 
       OR 
       (HOME_APPLICANT_INFO.DT_INVITE2 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
        and HOME_APPLICANT_INFO.DT_INVITE2  >= to_date($_StartDate,'MM/DD/YYYY')  ! first day of reporting period
        and HOME_APPLICANT_INFO.CD_INVITE2_STAT = 'ATT' ! means the status was Attended
       ) 
       OR 
       (HOME_APPLICANT_INFO.DT_INVITE3 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
        and HOME_APPLICANT_INFO.DT_INVITE3  >= to_date($_StartDate,'MM/DD/YYYY')  ! first day of reporting period
        and HOME_APPLICANT_INFO.CD_INVITE3_STAT = 'ATT' ! means the status was Attended
       )  
      )           
)
End-Select

Begin-SELECT DISTINCT 
count (distinct caps_resource.ID_RESOURCE) &_attend_train_adopt
FROM caps_resource
WHERE caps_resource.CD_RSRC_CATEGORY = 'L' !A for Adoptive homes
and caps_resource.IND_RSRC_NONDFCS = 'N'
and [$_where_clause_region_county_resc]
and exists 
( select *
  from HOME_APPLICANT_INFO
  where caps_resource.ID_RESOURCE = HOME_APPLICANT_INFO.ID_RESOURCE !join to outer query
  and (
       (HOME_APPLICANT_INFO.DT_INVITE1 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
        and HOME_APPLICANT_INFO.DT_INVITE1  >= to_date($_StartDate,'MM/DD/YYYY')  ! first day of reporting period
        and HOME_APPLICANT_INFO.CD_INVITE1_STAT = 'ATT' ! means the status was Attended
       ) 
       OR 
       (HOME_APPLICANT_INFO.DT_INVITE2 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
        and HOME_APPLICANT_INFO.DT_INVITE2  >= to_date($_StartDate,'MM/DD/YYYY') ! first day of reporting period
        and HOME_APPLICANT_INFO.CD_INVITE2_STAT = 'ATT' ! means the status was Attended
       ) 
       OR 
       (HOME_APPLICANT_INFO.DT_INVITE3 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
        and HOME_APPLICANT_INFO.DT_INVITE3  >= to_date($_StartDate,'MM/DD/YYYY') ! first day of reporting period
        and HOME_APPLICANT_INFO.CD_INVITE3_STAT = 'ATT' ! means the status was Attended
       )  
      )           
)
End-Select

Begin-SELECT DISTINCT 
count (distinct caps_resource.ID_RESOURCE) &_attend_train_relative_adopt
FROM caps_resource
WHERE caps_resource.CD_RSRC_CATEGORY = 'D' !D for Relative Adopt homes
and caps_resource.IND_RSRC_NONDFCS = 'N'
and [$_where_clause_region_county_resc]
and exists 
( select *
  from HOME_APPLICANT_INFO
  where caps_resource.ID_RESOURCE = HOME_APPLICANT_INFO.ID_RESOURCE !join to outer query
  and (
       (HOME_APPLICANT_INFO.DT_INVITE1 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
        and HOME_APPLICANT_INFO.DT_INVITE1  >= to_date($_StartDate,'MM/DD/YYYY') ! first day of reporting period
        and HOME_APPLICANT_INFO.CD_INVITE1_STAT = 'ATT' ! means the status was Attended
       ) 
       OR 
       (HOME_APPLICANT_INFO.DT_INVITE2 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
        and HOME_APPLICANT_INFO.DT_INVITE2  >= to_date($_StartDate,'MM/DD/YYYY') ! first day of reporting period
        and HOME_APPLICANT_INFO.CD_INVITE2_STAT = 'ATT' ! means the status was Attended
       ) 
       OR 
       (HOME_APPLICANT_INFO.DT_INVITE3 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
        and HOME_APPLICANT_INFO.DT_INVITE3  >= to_date($_StartDate,'MM/DD/YYYY') ! first day of reporting period
        and HOME_APPLICANT_INFO.CD_INVITE3_STAT = 'ATT' ! means the status was Attended
       )  
      )           
)
End-Select

Begin-SELECT DISTINCT 
count (distinct caps_resource.ID_RESOURCE) &_attend_train_relative_foster
FROM caps_resource
WHERE caps_resource.CD_RSRC_CATEGORY = 'O' !O for Relative Foster homes
and caps_resource.IND_RSRC_NONDFCS = 'N'
and [$_where_clause_region_county_resc]
and exists 
( select *
  from HOME_APPLICANT_INFO
  where caps_resource.ID_RESOURCE = HOME_APPLICANT_INFO.ID_RESOURCE !join to outer query
  and (
       (HOME_APPLICANT_INFO.DT_INVITE1 < to_date($_EndDate, 'MM/DD/YYYY') + 1! last day of reporting period
        and HOME_APPLICANT_INFO.DT_INVITE1  >= to_date($_StartDate,'MM/DD/YYYY') ! first day of reporting period
        and HOME_APPLICANT_INFO.CD_INVITE1_STAT = 'ATT' ! means the status was Attended
       ) 
       OR 
       (HOME_APPLICANT_INFO.DT_INVITE2 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
        and HOME_APPLICANT_INFO.DT_INVITE2  >= to_date($_StartDate,'MM/DD/YYYY') ! first day of reporting period
        and HOME_APPLICANT_INFO.CD_INVITE2_STAT = 'ATT' ! means the status was Attended
       ) 
       OR 
       (HOME_APPLICANT_INFO.DT_INVITE3 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
        and HOME_APPLICANT_INFO.DT_INVITE3  >= to_date($_StartDate,'MM/DD/YYYY') ! first day of reporting period
        and HOME_APPLICANT_INFO.CD_INVITE3_STAT = 'ATT' ! means the status was Attended
       )  
      )           
)
End-Select

Begin-SELECT DISTINCT 
count (distinct caps_resource.ID_RESOURCE) &_attend_train_ICPC_adopt
FROM caps_resource
WHERE caps_resource.CD_RSRC_CATEGORY = 'J' !J for ICPC Adopt homes
and caps_resource.IND_RSRC_NONDFCS = 'N'
and [$_where_clause_region_county_resc]
and exists 
( select *
  from HOME_APPLICANT_INFO
  where caps_resource.ID_RESOURCE = HOME_APPLICANT_INFO.ID_RESOURCE !join to outer query
  and (
       (HOME_APPLICANT_INFO.DT_INVITE1 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
        and HOME_APPLICANT_INFO.DT_INVITE1  >= to_date($_StartDate,'MM/DD/YYYY') ! first day of reporting period
        and HOME_APPLICANT_INFO.CD_INVITE1_STAT = 'ATT' ! means the status was Attended
       ) 
       OR 
       (HOME_APPLICANT_INFO.DT_INVITE2 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
        and HOME_APPLICANT_INFO.DT_INVITE2  >= to_date($_StartDate,'MM/DD/YYYY') ! first day of reporting period
        and HOME_APPLICANT_INFO.CD_INVITE2_STAT = 'ATT' ! means the status was Attended
       ) 
       OR 
       (HOME_APPLICANT_INFO.DT_INVITE3 < to_date($_EndDate, 'MM/DD/YYYY') + 1! last day of reporting period
        and HOME_APPLICANT_INFO.DT_INVITE3  >= to_date($_StartDate,'MM/DD/YYYY') ! first day of reporting period
        and HOME_APPLICANT_INFO.CD_INVITE3_STAT = 'ATT' ! means the status was Attended
       )  
      )           
)
End-Select

Begin-SELECT DISTINCT 
count (distinct caps_resource.ID_RESOURCE) &_attend_train_ICPC_foster
FROM caps_resource
WHERE caps_resource.CD_RSRC_CATEGORY = 'I' !I for ICPC Foster homes
and caps_resource.IND_RSRC_NONDFCS = 'N'
and [$_where_clause_region_county_resc]
and exists 
( select *
  from HOME_APPLICANT_INFO
  where caps_resource.ID_RESOURCE = HOME_APPLICANT_INFO.ID_RESOURCE !join to outer query
  and (
       (HOME_APPLICANT_INFO.DT_INVITE1 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
        and HOME_APPLICANT_INFO.DT_INVITE1  >= to_date($_StartDate,'MM/DD/YYYY') ! first day of reporting period
        and HOME_APPLICANT_INFO.CD_INVITE1_STAT = 'ATT' ! means the status was Attended
       ) 
       OR 
       (HOME_APPLICANT_INFO.DT_INVITE2 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
        and HOME_APPLICANT_INFO.DT_INVITE2  >= to_date($_StartDate,'MM/DD/YYYY') ! first day of reporting period
        and HOME_APPLICANT_INFO.CD_INVITE2_STAT = 'ATT' ! means the status was Attended
       ) 
       OR 
       (HOME_APPLICANT_INFO.DT_INVITE3 < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
        and HOME_APPLICANT_INFO.DT_INVITE3  >= to_date($_StartDate,'MM/DD/YYYY') ! first day of reporting period
        and HOME_APPLICANT_INFO.CD_INVITE3_STAT = 'ATT' ! means the status was Attended
       )  
      )           
)
End-Select

End-Procedure

Begin-Procedure Home-Approval
Begin-Select distinct 
count (distinct resource_history.ID_RESOURCE)  &_full_approval_foster
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'AFA'
AND resource_history.IND_RSRC_NONDFCS = 'N'
AND resource_history.CD_RSHS_CATEGORY = 'F'
and [$_where_clause_region_county_hist]
End-Select

Begin-Select distinct
count (distinct resource_history.ID_RESOURCE)  &_full_approval_legal
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'AFA'
AND resource_history.IND_RSRC_NONDFCS = 'N'
AND resource_history.CD_RSHS_CATEGORY = 'L'
and [$_where_clause_region_county_hist]
End-Select

Begin-Select distinct 
count (distinct resource_history.ID_RESOURCE)  &_full_approval_adopt
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'AFA'
AND resource_history.IND_RSRC_NONDFCS = 'N'
AND resource_history.CD_RSHS_CATEGORY = 'A'
and [$_where_clause_region_county_hist]
End-Select

Begin-Select distinct 
count (distinct resource_history.ID_RESOURCE)  &_full_approval_relative_adopt
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'AFA'
AND resource_history.IND_RSRC_NONDFCS = 'N'
AND resource_history.CD_RSHS_CATEGORY = 'D'
and [$_where_clause_region_county_hist]
End-Select

Begin-Select distinct 
count (distinct resource_history.ID_RESOURCE)  &_full_approval_relative_foster
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'AFA'
AND resource_history.IND_RSRC_NONDFCS = 'N'
AND resource_history.CD_RSHS_CATEGORY = 'O'
and [$_where_clause_region_county_hist]
End-Select

Begin-Select distinct 
count (distinct resource_history.ID_RESOURCE)  &_full_approval_ICPC_adopt
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'AFA'
AND resource_history.IND_RSRC_NONDFCS = 'N'
AND resource_history.CD_RSHS_CATEGORY = 'J'
and [$_where_clause_region_county_hist]
End-Select

Begin-Select distinct 
count (distinct resource_history.ID_RESOURCE)  &_full_approval_ICPC_foster
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'AFA'
AND resource_history.IND_RSRC_NONDFCS = 'N'
AND resource_history.CD_RSHS_CATEGORY = 'I'
and [$_where_clause_region_county_hist]
End-Select

Begin-Select distinct 
count (distinct resource_history.ID_RESOURCE)  &_special_approval_foster
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'ASA'
AND resource_history.IND_RSRC_NONDFCS = 'N'
AND resource_history.CD_RSHS_CATEGORY = 'F'
and [$_where_clause_region_county_hist]
End-Select

Begin-Select distinct
count (distinct resource_history.ID_RESOURCE)  &_special_approval_legal
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'ASA'
AND resource_history.IND_RSRC_NONDFCS = 'N'
AND resource_history.CD_RSHS_CATEGORY = 'L'
and [$_where_clause_region_county_hist]
End-Select

Begin-Select distinct 
count (distinct resource_history.ID_RESOURCE)  &_special_approval_adopt
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'ASA'
AND resource_history.IND_RSRC_NONDFCS = 'N'
AND resource_history.CD_RSHS_CATEGORY = 'A'
and [$_where_clause_region_county_hist]
End-Select

Begin-Select distinct 
count (distinct resource_history.ID_RESOURCE)  &_special_approval_relative_adopt
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'ASA'
AND resource_history.IND_RSRC_NONDFCS = 'N'
AND resource_history.CD_RSHS_CATEGORY = 'D'
and [$_where_clause_region_county_hist]
End-Select

Begin-Select distinct 
count (distinct resource_history.ID_RESOURCE)  &_special_approval_relative_foster
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1!last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'ASA'
AND resource_history.IND_RSRC_NONDFCS = 'N'
AND resource_history.CD_RSHS_CATEGORY = 'O'
and [$_where_clause_region_county_hist]
End-Select

Begin-Select distinct 
count (distinct resource_history.ID_RESOURCE)  &_special_approval_ICPC_adopt
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'ASA'
AND resource_history.IND_RSRC_NONDFCS = 'N'
AND resource_history.CD_RSHS_CATEGORY = 'J'
and [$_where_clause_region_county_hist]
End-Select

Begin-Select distinct 
count (distinct resource_history.ID_RESOURCE)  &_special_approval_ICPC_foster
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'ASA'
AND resource_history.IND_RSRC_NONDFCS = 'N'
AND resource_history.CD_RSHS_CATEGORY = 'I'
and [$_where_clause_region_county_hist]
End-Select


! Calculation for Full Approval 30 day Grace
Begin-Select distinct 
count (distinct resource_history.ID_RESOURCE)  &_full_grace_approval_foster
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')  !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'FLG'
AND resource_history.IND_RSRC_NONDFCS = 'N'
AND resource_history.CD_RSHS_CATEGORY = 'F'
and [$_where_clause_region_county_hist]
End-Select


Begin-Select distinct
count (distinct resource_history.ID_RESOURCE)  &_full_grace_approval_legal
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'FLG'
AND resource_history.IND_RSRC_NONDFCS = 'N'
AND resource_history.CD_RSHS_CATEGORY = 'L'
and [$_where_clause_region_county_hist]
End-Select

Begin-Select distinct 
count (distinct resource_history.ID_RESOURCE)  &_full_grace_approval_adopt
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'FLG'
AND resource_history.IND_RSRC_NONDFCS = 'N'
AND resource_history.CD_RSHS_CATEGORY = 'A'
and [$_where_clause_region_county_hist]
End-Select

Begin-Select distinct 
count (distinct resource_history.ID_RESOURCE)  &_full_grace_approval_relative_adopt
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'FLG'
AND resource_history.IND_RSRC_NONDFCS = 'N'
AND resource_history.CD_RSHS_CATEGORY = 'D'
and [$_where_clause_region_county_hist]
End-Select

Begin-Select distinct 
count (distinct resource_history.ID_RESOURCE)  &_full_grace_approval_relative_foster
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'FLG'
AND resource_history.IND_RSRC_NONDFCS = 'N'
AND resource_history.CD_RSHS_CATEGORY = 'O'
and [$_where_clause_region_county_hist]
End-Select

Begin-Select distinct 
count (distinct resource_history.ID_RESOURCE)  &_full_grace_approval_ICPC_adopt
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'FLG'
AND resource_history.IND_RSRC_NONDFCS = 'N'
AND resource_history.CD_RSHS_CATEGORY = 'J'
and [$_where_clause_region_county_hist]
End-Select

Begin-Select distinct 
count (distinct resource_history.ID_RESOURCE)  &_full_grace_approval_ICPC_foster
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'FLG'
AND resource_history.IND_RSRC_NONDFCS = 'N'
AND resource_history.CD_RSHS_CATEGORY = 'I'
and [$_where_clause_region_county_hist]
End-Select


! Calculation for Special Approval 30 day Grace
Begin-Select distinct 
count (distinct resource_history.ID_RESOURCE)  &_special_grace_approval_foster
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'FSG'
AND resource_history.IND_RSRC_NONDFCS = 'N'
AND resource_history.CD_RSHS_CATEGORY = 'F'
and [$_where_clause_region_county_hist]
End-Select


Begin-Select distinct
count (distinct resource_history.ID_RESOURCE)  &_special_grace_approval_legal
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'FSG'
AND resource_history.IND_RSRC_NONDFCS = 'N'
AND resource_history.CD_RSHS_CATEGORY = 'L'
and [$_where_clause_region_county_hist]
End-Select

Begin-Select distinct 
count (distinct resource_history.ID_RESOURCE)  &_special_grace_approval_adopt
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'FSG'
AND resource_history.IND_RSRC_NONDFCS = 'N'
AND resource_history.CD_RSHS_CATEGORY = 'A'
and [$_where_clause_region_county_hist]
End-Select

Begin-Select distinct 
count (distinct resource_history.ID_RESOURCE)  &_special_grace_approval_rel_adopt
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'FSG'
AND resource_history.IND_RSRC_NONDFCS = 'N'
AND resource_history.CD_RSHS_CATEGORY = 'D'
and [$_where_clause_region_county_hist]
End-Select

Begin-Select distinct 
count (distinct resource_history.ID_RESOURCE)  &_special_grace_approval_rel_foster
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'FSG'
AND resource_history.IND_RSRC_NONDFCS = 'N'
AND resource_history.CD_RSHS_CATEGORY = 'O'
and [$_where_clause_region_county_hist]
End-Select

Begin-Select distinct 
count (distinct resource_history.ID_RESOURCE)  &_special_grace_approval_ICPC_adopt
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'FSG'
AND resource_history.IND_RSRC_NONDFCS = 'N'
AND resource_history.CD_RSHS_CATEGORY = 'J'
and [$_where_clause_region_county_hist]
End-Select

Begin-Select distinct 
count (distinct resource_history.ID_RESOURCE)  &_special_grace_approval_ICPC_foster
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'FSG'
AND resource_history.IND_RSRC_NONDFCS = 'N'
AND resource_history.CD_RSHS_CATEGORY = 'I'
and [$_where_clause_region_county_hist]
End-Select


! No longer use Temporary Approval due to MR-0675 
!Begin-Select distinct 
!count (distinct resource_history.ID_RESOURCE)  &_temp_approval_foster
!FROM resource_history
!WHERE resource_history.DT_RSHS_EFFECTIVE >= (to_date ($_ReportMonth, 'MM/YYYY')) !last day of reporting period
!AND resource_history.DT_RSHS_EFFECTIVE < (last_day (to_date ($_ReportMonth, 'MM/YYYY'))+1) !last day of reporting period
!AD resource_history.CD_RSHS_FA_HOME_STATUS = 'ATA'
!AND resource_history.IND_RSRC_NONDFCS = 'N'
!AND resource_history.CD_RSHS_CATEGORY = 'F'
!and [$_where_clause_region_county_hist]
!End-Select

!Begin-Select distinct
!count (distinct resource_history.ID_RESOURCE)  &_temp_approval_legal
!FROM resource_history
!WHERE resource_history.DT_RSHS_EFFECTIVE >= (to_date ($_ReportMonth, 'MM/YYYY')) !first day of reporting period
!AND resource_history.DT_RSHS_EFFECTIVE < (last_day (to_date ($_ReportMonth, 'MM/YYYY'))+1) !last day of reporting period
!AND resource_history.CD_RSHS_FA_HOME_STATUS = 'ATA'
!AND resource_history.IND_RSRC_NONDFCS = 'N'
!AND resource_history.CD_RSHS_CATEGORY = 'L'
!and [$_where_clause_region_county_hist]
!End-Select

!Begin-Select distinct 
!count (distinct resource_history.ID_RESOURCE)  &_temp_approval_adopt
!FROM resource_history
!WHERE resource_history.DT_RSHS_EFFECTIVE >= (to_date ($_ReportMonth, 'MM/YYYY')) !first day of reporting period
!AND resource_history.DT_RSHS_EFFECTIVE < (last_day (to_date ($_ReportMonth, 'MM/YYYY'))+1) !last day of reporting period
!AND resource_history.CD_RSHS_FA_HOME_STATUS = 'ATA'
!AND resource_history.IND_RSRC_NONDFCS = 'N'
!AND resource_history.CD_RSHS_CATEGORY = 'A'
!and [$_where_clause_region_county_hist]
!End-Select
End-Procedure

Begin-Procedure Home-Capacity
Begin-Select distinct
sum(resource_history.NBR_RSHS_FACIL_CAPACITY) &_full_app_capacity_foster
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'AFA' 
AND resource_history.CD_RSHS_CATEGORY = 'F'
AND resource_history.IND_RSRC_NONDFCS = 'N' 
and [$_where_clause_region_county_hist]
and resource_history.ID_RESOURCE_HISTORY = 
(select max (resource_history_max.ID_RESOURCE_HISTORY)
   from resource_history resource_history_max
   WHERE resource_history_max.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
   AND resource_history_max.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
   AND resource_history_max.CD_RSHS_FA_HOME_STATUS = 'AFA'   
   AND resource_history_max.CD_RSHS_CATEGORY = 'F'  !for Foster homes
   AND resource_history_max.IND_RSRC_NONDFCS = 'N'
   and resource_history.ID_RESOURCE = resource_history_max.ID_RESOURCE  !join by resource id to the outer query
)
End-Select

Begin-Select distinct
sum(resource_history.NBR_RSHS_FACIL_CAPACITY) &_full_app_capacity_legal
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'AFA' 
AND resource_history.CD_RSHS_CATEGORY = 'L'
AND resource_history.IND_RSRC_NONDFCS = 'N' 
and [$_where_clause_region_county_hist]
and resource_history.ID_RESOURCE_HISTORY = 
(select max (resource_history_max.ID_RESOURCE_HISTORY)
   from resource_history resource_history_max
   WHERE resource_history_max.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
   AND resource_history_max.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
   AND resource_history_max.CD_RSHS_FA_HOME_STATUS = 'AFA'   
   AND resource_history_max.CD_RSHS_CATEGORY = 'L'  ! for Legal Risk home
   AND resource_history_max.IND_RSRC_NONDFCS = 'N'
   and resource_history.ID_RESOURCE = resource_history_max.ID_RESOURCE  !join by resource id to the outer query
)
End-Select

Begin-Select distinct
sum(resource_history.NBR_RSHS_FACIL_CAPACITY) &_full_app_capacity_adopt
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'AFA' 
AND resource_history.CD_RSHS_CATEGORY = 'A'
AND resource_history.IND_RSRC_NONDFCS = 'N' 
and [$_where_clause_region_county_hist]
and resource_history.ID_RESOURCE_HISTORY = 
(select max (resource_history_max.ID_RESOURCE_HISTORY)
   from resource_history resource_history_max
   WHERE resource_history_max.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
   AND resource_history_max.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
   AND resource_history_max.CD_RSHS_FA_HOME_STATUS = 'AFA'   
   AND resource_history_max.CD_RSHS_CATEGORY = 'A'  ! for Adoptive home
   AND resource_history_max.IND_RSRC_NONDFCS = 'N'
   and resource_history.ID_RESOURCE = resource_history_max.ID_RESOURCE  !join by resource id to the outer query
)
End-Select

Begin-Select distinct
sum(resource_history.NBR_RSHS_FACIL_CAPACITY) &_full_app_capacity_rel_adopt
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'AFA' 
AND resource_history.CD_RSHS_CATEGORY = 'D'
AND resource_history.IND_RSRC_NONDFCS = 'N' 
and [$_where_clause_region_county_hist]
and resource_history.ID_RESOURCE_HISTORY = 
(select max (resource_history_max.ID_RESOURCE_HISTORY)
   from resource_history resource_history_max
   WHERE resource_history_max.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
   AND resource_history_max.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
   AND resource_history_max.CD_RSHS_FA_HOME_STATUS = 'AFA'   
   AND resource_history_max.CD_RSHS_CATEGORY = 'D'  ! for Relative Adopt home
   AND resource_history_max.IND_RSRC_NONDFCS = 'N'
   and resource_history.ID_RESOURCE = resource_history_max.ID_RESOURCE  !join by resource id to the outer query
)
End-Select

Begin-Select distinct
sum(resource_history.NBR_RSHS_FACIL_CAPACITY) &_full_app_capacity_rel_foster
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1!last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'AFA' 
AND resource_history.CD_RSHS_CATEGORY = 'O'
AND resource_history.IND_RSRC_NONDFCS = 'N' 
and [$_where_clause_region_county_hist]
and resource_history.ID_RESOURCE_HISTORY = 
(select max (resource_history_max.ID_RESOURCE_HISTORY)
   from resource_history resource_history_max
   WHERE resource_history_max.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
   AND resource_history_max.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
   AND resource_history_max.CD_RSHS_FA_HOME_STATUS = 'AFA'   
   AND resource_history_max.CD_RSHS_CATEGORY = 'O'  ! for Relative Foster home
   AND resource_history_max.IND_RSRC_NONDFCS = 'N'
   and resource_history.ID_RESOURCE = resource_history_max.ID_RESOURCE  !join by resource id to the outer query
)
End-Select

Begin-Select distinct
sum(resource_history.NBR_RSHS_FACIL_CAPACITY) &_full_app_capacity_ICPC_adopt
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'AFA' 
AND resource_history.CD_RSHS_CATEGORY = 'J'
AND resource_history.IND_RSRC_NONDFCS = 'N' 
and [$_where_clause_region_county_hist]
and resource_history.ID_RESOURCE_HISTORY = 
(select max (resource_history_max.ID_RESOURCE_HISTORY)
   from resource_history resource_history_max
   WHERE resource_history_max.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
   AND resource_history_max.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
   AND resource_history_max.CD_RSHS_FA_HOME_STATUS = 'AFA'   
   AND resource_history_max.CD_RSHS_CATEGORY = 'J'  ! for ICPC Adopt home
   AND resource_history_max.IND_RSRC_NONDFCS = 'N'
   and resource_history.ID_RESOURCE = resource_history_max.ID_RESOURCE  !join by resource id to the outer query
)
End-Select

Begin-Select distinct
sum(resource_history.NBR_RSHS_FACIL_CAPACITY) &_full_app_capacity_ICPC_foster
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'AFA' 
AND resource_history.CD_RSHS_CATEGORY = 'I'
AND resource_history.IND_RSRC_NONDFCS = 'N' 
and [$_where_clause_region_county_hist]
and resource_history.ID_RESOURCE_HISTORY = 
(select max (resource_history_max.ID_RESOURCE_HISTORY)
   from resource_history resource_history_max
   WHERE resource_history_max.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
   AND resource_history_max.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
   AND resource_history_max.CD_RSHS_FA_HOME_STATUS = 'AFA'   
   AND resource_history_max.CD_RSHS_CATEGORY = 'I'  ! for ICPC foster
   AND resource_history_max.IND_RSRC_NONDFCS = 'N'
   and resource_history.ID_RESOURCE = resource_history_max.ID_RESOURCE  !join by resource id to the outer query
)
End-Select



Begin-Select distinct
sum(resource_history.NBR_RSHS_FACIL_CAPACITY) &_special_app_capacity_foster
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')  !first day of reporting period 
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'ASA' 
AND resource_history.CD_RSHS_CATEGORY = 'F'
AND resource_history.IND_RSRC_NONDFCS = 'N' 
and [$_where_clause_region_county_hist]
and resource_history.ID_RESOURCE_HISTORY = 
(select max (resource_history_max.ID_RESOURCE_HISTORY)
   from resource_history resource_history_max
   WHERE resource_history_max.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
   AND resource_history_max.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
   AND resource_history_max.CD_RSHS_FA_HOME_STATUS = 'ASA'   
   AND resource_history_max.CD_RSHS_CATEGORY = 'F'  ! for foster home
   AND resource_history_max.IND_RSRC_NONDFCS = 'N'
   and resource_history.ID_RESOURCE = resource_history_max.ID_RESOURCE  !join by resource id to the outer query
) 
End-Select

Begin-Select distinct
sum(resource_history.NBR_RSHS_FACIL_CAPACITY) &_special_app_capacity_legal
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')  !first day of reporting period 
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1!last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'ASA' 
AND resource_history.CD_RSHS_CATEGORY = 'L'
AND resource_history.IND_RSRC_NONDFCS = 'N' 
and [$_where_clause_region_county_hist]
and resource_history.ID_RESOURCE_HISTORY = 
(select max (resource_history_max.ID_RESOURCE_HISTORY)
   from resource_history resource_history_max
   WHERE resource_history_max.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
   AND resource_history_max.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
   AND resource_history_max.CD_RSHS_FA_HOME_STATUS = 'ASA'   
   AND resource_history_max.CD_RSHS_CATEGORY = 'L'  !for Legal Risk home
   AND resource_history_max.IND_RSRC_NONDFCS = 'N'
   and resource_history.ID_RESOURCE = resource_history_max.ID_RESOURCE  !join by resource id to the outer query
) 
End-Select

Begin-Select distinct
sum(resource_history.NBR_RSHS_FACIL_CAPACITY) &_special_app_capacity_adopt
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')  !first day of reporting period 
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'ASA' 
AND resource_history.CD_RSHS_CATEGORY = 'A'
AND resource_history.IND_RSRC_NONDFCS = 'N' 
and [$_where_clause_region_county_hist]
and resource_history.ID_RESOURCE_HISTORY = 
(select max (resource_history_max.ID_RESOURCE_HISTORY)
   from resource_history resource_history_max
   WHERE resource_history_max.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
   AND resource_history_max.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
   AND resource_history_max.CD_RSHS_FA_HOME_STATUS = 'ASA' 
   AND resource_history_max.CD_RSHS_CATEGORY = 'A'  !for Adoptive home
   AND resource_history_max.IND_RSRC_NONDFCS = 'N'
   and resource_history.ID_RESOURCE = resource_history_max.ID_RESOURCE  !join by resource id to the outer query
) 
End-Select

Begin-Select distinct
sum(resource_history.NBR_RSHS_FACIL_CAPACITY) &_special_app_capacity_rel_adopt
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')   !first day of reporting period 
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1!last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'ASA' 
AND resource_history.CD_RSHS_CATEGORY = 'D'
AND resource_history.IND_RSRC_NONDFCS = 'N' 
and [$_where_clause_region_county_hist]
and resource_history.ID_RESOURCE_HISTORY = 
(select max (resource_history_max.ID_RESOURCE_HISTORY)
   from resource_history resource_history_max
   WHERE resource_history_max.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
   AND resource_history_max.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')  !first day of reporting period
   AND resource_history_max.CD_RSHS_FA_HOME_STATUS = 'ASA'   
   AND resource_history_max.CD_RSHS_CATEGORY = 'D'  ! for relative adopt home
   AND resource_history_max.IND_RSRC_NONDFCS = 'N'
   and resource_history.ID_RESOURCE = resource_history_max.ID_RESOURCE  !join by resource id to the outer query
) 
End-Select

Begin-Select distinct
sum(resource_history.NBR_RSHS_FACIL_CAPACITY) &_special_app_capacity_rel_foster
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')  !first day of reporting period 
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'ASA' 
AND resource_history.CD_RSHS_CATEGORY = 'O'
AND resource_history.IND_RSRC_NONDFCS = 'N' 
and [$_where_clause_region_county_hist]
and resource_history.ID_RESOURCE_HISTORY = 
(select max (resource_history_max.ID_RESOURCE_HISTORY)
   from resource_history resource_history_max
   WHERE resource_history_max.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
   AND resource_history_max.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')  !first day of reporting period
   AND resource_history_max.CD_RSHS_FA_HOME_STATUS = 'ASA'   
   AND resource_history_max.CD_RSHS_CATEGORY = 'O'  ! for relative foster home
   AND resource_history_max.IND_RSRC_NONDFCS = 'N'
   and resource_history.ID_RESOURCE = resource_history_max.ID_RESOURCE  !join by resource id to the outer query
) 
End-Select

Begin-Select distinct
sum(resource_history.NBR_RSHS_FACIL_CAPACITY) &_special_app_capacity_ICPC_adopt
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')   !first day of reporting period 
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1!last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'ASA' 
AND resource_history.CD_RSHS_CATEGORY = 'J'
AND resource_history.IND_RSRC_NONDFCS = 'N' 
and [$_where_clause_region_county_hist]
and resource_history.ID_RESOURCE_HISTORY = 
(select max (resource_history_max.ID_RESOURCE_HISTORY)
   from resource_history resource_history_max
   WHERE resource_history_max.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
   AND resource_history_max.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')  !first day of reporting period
   AND resource_history_max.CD_RSHS_FA_HOME_STATUS = 'ASA'   
   AND resource_history_max.CD_RSHS_CATEGORY = 'J'  ! for ICPC adopt home
   AND resource_history_max.IND_RSRC_NONDFCS = 'N'
   and resource_history.ID_RESOURCE = resource_history_max.ID_RESOURCE  !join by resource id to the outer query
) 
End-Select

Begin-Select distinct
sum(resource_history.NBR_RSHS_FACIL_CAPACITY) &_special_app_capacity_ICPC_foster
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')   !first day of reporting period 
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'ASA' 
AND resource_history.CD_RSHS_CATEGORY = 'I'
AND resource_history.IND_RSRC_NONDFCS = 'N' 
and [$_where_clause_region_county_hist]
and resource_history.ID_RESOURCE_HISTORY = 
(select max (resource_history_max.ID_RESOURCE_HISTORY)
   from resource_history resource_history_max
   WHERE resource_history_max.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
   AND resource_history_max.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
   AND resource_history_max.CD_RSHS_FA_HOME_STATUS = 'ASA'   
   AND resource_history_max.CD_RSHS_CATEGORY = 'I'  ! for ICPC foster home
   AND resource_history_max.IND_RSRC_NONDFCS = 'N'
   and resource_history.ID_RESOURCE = resource_history_max.ID_RESOURCE  !join by resource id to the outer query
) 
End-Select


! Full Approval 30 Day Grace Capacity Count
Begin-Select distinct
sum(resource_history.NBR_RSHS_FACIL_CAPACITY) &_full_grace_app_capacity_foster
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')   !first day of reporting period 
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'FLG' 
AND resource_history.CD_RSHS_CATEGORY = 'F'
AND resource_history.IND_RSRC_NONDFCS = 'N' 
and [$_where_clause_region_county_hist]
and resource_history.ID_RESOURCE_HISTORY = 
(select max (resource_history_max.ID_RESOURCE_HISTORY)
   from resource_history resource_history_max
   WHERE resource_history_max.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1!last day of reporting period
   AND resource_history_max.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')  !first day of reporting period
   AND resource_history_max.CD_RSHS_FA_HOME_STATUS = 'FLG'   
   AND resource_history_max.CD_RSHS_CATEGORY = 'F'  ! for foster home
   AND resource_history_max.IND_RSRC_NONDFCS = 'N'
   and resource_history.ID_RESOURCE = resource_history_max.ID_RESOURCE  !join by resource id to the outer query
) 
End-Select


Begin-Select distinct
sum(resource_history.NBR_RSHS_FACIL_CAPACITY) &_full_grace_app_capacity_legal
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')   !first day of reporting period 
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1!last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'FLG' 
AND resource_history.CD_RSHS_CATEGORY = 'L'
AND resource_history.IND_RSRC_NONDFCS = 'N' 
and [$_where_clause_region_county_hist]
and resource_history.ID_RESOURCE_HISTORY = 
(select max (resource_history_max.ID_RESOURCE_HISTORY)
   from resource_history resource_history_max
   WHERE resource_history_max.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
   AND resource_history_max.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
   AND resource_history_max.CD_RSHS_FA_HOME_STATUS = 'FLG'   
   AND resource_history_max.CD_RSHS_CATEGORY = 'L'  ! for legal risk home
   AND resource_history_max.IND_RSRC_NONDFCS = 'N'
   and resource_history.ID_RESOURCE = resource_history_max.ID_RESOURCE  !join by resource id to the outer query
) 
End-Select


Begin-Select distinct
sum(resource_history.NBR_RSHS_FACIL_CAPACITY) &_full_grace_app_capacity_adopt
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')   !first day of reporting period 
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'FLG' 
AND resource_history.CD_RSHS_CATEGORY = 'A'
AND resource_history.IND_RSRC_NONDFCS = 'N' 
and [$_where_clause_region_county_hist]
and resource_history.ID_RESOURCE_HISTORY = 
(select max (resource_history_max.ID_RESOURCE_HISTORY)
   from resource_history resource_history_max
   WHERE resource_history_max.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
   AND resource_history_max.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')  !first day of reporting period
   AND resource_history_max.CD_RSHS_FA_HOME_STATUS = 'FLG'   
   AND resource_history_max.CD_RSHS_CATEGORY = 'A'  ! for adoption home
   AND resource_history_max.IND_RSRC_NONDFCS = 'N'
   and resource_history.ID_RESOURCE = resource_history_max.ID_RESOURCE  !join by resource id to the outer query
) 
End-Select

Begin-Select distinct
sum(resource_history.NBR_RSHS_FACIL_CAPACITY) &_full_grace_app_capacity_rel_adopt
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')   !first day of reporting period 
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'FLG' 
AND resource_history.CD_RSHS_CATEGORY = 'D'
AND resource_history.IND_RSRC_NONDFCS = 'N' 
and [$_where_clause_region_county_hist]
and resource_history.ID_RESOURCE_HISTORY = 
(select max (resource_history_max.ID_RESOURCE_HISTORY)
   from resource_history resource_history_max
   WHERE resource_history_max.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
   AND resource_history_max.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')  !first day of reporting period
   AND resource_history_max.CD_RSHS_FA_HOME_STATUS = 'FLG'   
   AND resource_history_max.CD_RSHS_CATEGORY = 'D'  ! for relative adopt home
   AND resource_history_max.IND_RSRC_NONDFCS = 'N'
   and resource_history.ID_RESOURCE = resource_history_max.ID_RESOURCE  !join by resource id to the outer query
) 
End-Select

Begin-Select distinct
sum(resource_history.NBR_RSHS_FACIL_CAPACITY) &_full_grace_app_capacity_rel_foster
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')   !first day of reporting period 
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'FLG' 
AND resource_history.CD_RSHS_CATEGORY = 'O'
AND resource_history.IND_RSRC_NONDFCS = 'N' 
and [$_where_clause_region_county_hist]
and resource_history.ID_RESOURCE_HISTORY = 
(select max (resource_history_max.ID_RESOURCE_HISTORY)
   from resource_history resource_history_max
   WHERE resource_history_max.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
   AND resource_history_max.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')  !first day of reporting period
   AND resource_history_max.CD_RSHS_FA_HOME_STATUS = 'FLG'   
   AND resource_history_max.CD_RSHS_CATEGORY = 'O'  ! for relative foster home
   AND resource_history_max.IND_RSRC_NONDFCS = 'N'
   and resource_history.ID_RESOURCE = resource_history_max.ID_RESOURCE  !join by resource id to the outer query
) 
End-Select

Begin-Select distinct
sum(resource_history.NBR_RSHS_FACIL_CAPACITY) &_full_grace_app_capacity_ICPC_adopt
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')  !first day of reporting period 
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1!last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'FLG' 
AND resource_history.CD_RSHS_CATEGORY = 'J'
AND resource_history.IND_RSRC_NONDFCS = 'N' 
and [$_where_clause_region_county_hist]
and resource_history.ID_RESOURCE_HISTORY = 
(select max (resource_history_max.ID_RESOURCE_HISTORY)
   from resource_history resource_history_max
   WHERE resource_history_max.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
   AND resource_history_max.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')  !first day of reporting period
   AND resource_history_max.CD_RSHS_FA_HOME_STATUS = 'FLG'   
   AND resource_history_max.CD_RSHS_CATEGORY = 'J'  ! for ICPCC adopt home
   AND resource_history_max.IND_RSRC_NONDFCS = 'N'
   and resource_history.ID_RESOURCE = resource_history_max.ID_RESOURCE  !join by resource id to the outer query
) 
End-Select

Begin-Select distinct
sum(resource_history.NBR_RSHS_FACIL_CAPACITY) &_full_grace_app_capacity_ICPC_foster
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')   !first day of reporting period 
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1!last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'FLG' 
AND resource_history.CD_RSHS_CATEGORY = 'I'
AND resource_history.IND_RSRC_NONDFCS = 'N' 
and [$_where_clause_region_county_hist]
and resource_history.ID_RESOURCE_HISTORY = 
(select max (resource_history_max.ID_RESOURCE_HISTORY)
   from resource_history resource_history_max
   WHERE resource_history_max.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
   AND resource_history_max.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')  !first day of reporting period
   AND resource_history_max.CD_RSHS_FA_HOME_STATUS = 'FLG'   
   AND resource_history_max.CD_RSHS_CATEGORY = 'I'  ! for ICPC foster home
   AND resource_history_max.IND_RSRC_NONDFCS = 'N'
   and resource_history.ID_RESOURCE = resource_history_max.ID_RESOURCE  !join by resource id to the outer query
) 
End-Select


! Special Approval 30 Day Grace Capacity Count
Begin-Select distinct
sum(resource_history.NBR_RSHS_FACIL_CAPACITY) &_special_grace_app_capacity_foster
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')  !first day of reporting period 
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'FSG' 
AND resource_history.CD_RSHS_CATEGORY = 'F'
AND resource_history.IND_RSRC_NONDFCS = 'N' 
!and [$_where_clause201]
!and [$_where_clause202]
and [$_where_clause_region_county_hist]
and resource_history.ID_RESOURCE_HISTORY = 
(select max (resource_history_max.ID_RESOURCE_HISTORY)
   from resource_history resource_history_max
   WHERE resource_history_max.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
   AND resource_history_max.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
   AND resource_history_max.CD_RSHS_FA_HOME_STATUS = 'FSG'   
   AND resource_history_max.CD_RSHS_CATEGORY = 'F'  ! for foster home
   AND resource_history_max.IND_RSRC_NONDFCS = 'N'
   and resource_history.ID_RESOURCE = resource_history_max.ID_RESOURCE  !join by resource id to the outer query
) 
End-Select

Begin-Select distinct
sum(resource_history.NBR_RSHS_FACIL_CAPACITY) &_special_grace_app_capacity_legal
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')   !first day of reporting period 
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'FSG' 
AND resource_history.CD_RSHS_CATEGORY = 'L'
AND resource_history.IND_RSRC_NONDFCS = 'N' 
!and [$_where_clause201]
!and [$_where_clause202]
and [$_where_clause_region_county_hist]
and resource_history.ID_RESOURCE_HISTORY = 
(select max (resource_history_max.ID_RESOURCE_HISTORY)
   from resource_history resource_history_max
   WHERE resource_history_max.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
   AND resource_history_max.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')  !first day of reporting period
   AND resource_history_max.CD_RSHS_FA_HOME_STATUS = 'FSG'   
   AND resource_history_max.CD_RSHS_CATEGORY = 'L'  ! for legal home
   AND resource_history_max.IND_RSRC_NONDFCS = 'N'
   and resource_history.ID_RESOURCE = resource_history_max.ID_RESOURCE  !join by resource id to the outer query
) 
End-Select


Begin-Select distinct
sum(resource_history.NBR_RSHS_FACIL_CAPACITY) &_special_grace_app_capacity_adopt
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')  !first day of reporting period 
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'FSG' 
AND resource_history.CD_RSHS_CATEGORY = 'A'
AND resource_history.IND_RSRC_NONDFCS = 'N' 
!and [$_where_clause201]
!and [$_where_clause202]
and [$_where_clause_region_county_hist]
and resource_history.ID_RESOURCE_HISTORY = 
(select max (resource_history_max.ID_RESOURCE_HISTORY)
   from resource_history resource_history_max
   WHERE resource_history_max.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
   AND resource_history_max.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
   AND resource_history_max.CD_RSHS_FA_HOME_STATUS = 'FSG'   
   AND resource_history_max.CD_RSHS_CATEGORY = 'A'  ! for adoption home
   AND resource_history_max.IND_RSRC_NONDFCS = 'N'
   and resource_history.ID_RESOURCE = resource_history_max.ID_RESOURCE  !join by resource id to the outer query
) 
End-Select

Begin-Select distinct
sum(resource_history.NBR_RSHS_FACIL_CAPACITY) &_special_grace_app_capacity_rel_adopt
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')  !first day of reporting period 
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'FSG' 
AND resource_history.CD_RSHS_CATEGORY = 'D'
AND resource_history.IND_RSRC_NONDFCS = 'N' 
!and [$_where_clause201]
!and [$_where_clause202]
and [$_where_clause_region_county_hist]
and resource_history.ID_RESOURCE_HISTORY = 
(select max (resource_history_max.ID_RESOURCE_HISTORY)
   from resource_history resource_history_max
   WHERE resource_history_max.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1!last day of reporting period
   AND resource_history_max.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
   AND resource_history_max.CD_RSHS_FA_HOME_STATUS = 'FSG'   
   AND resource_history_max.CD_RSHS_CATEGORY = 'D'  ! for Relagtive adopt home
   AND resource_history_max.IND_RSRC_NONDFCS = 'N'
   and resource_history.ID_RESOURCE = resource_history_max.ID_RESOURCE  !join by resource id to the outer query
) 
End-Select

Begin-Select distinct
sum(resource_history.NBR_RSHS_FACIL_CAPACITY) &_special_grace_app_capacity_rel_foster
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')  !first day of reporting period 
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'FSG' 
AND resource_history.CD_RSHS_CATEGORY = 'O'
AND resource_history.IND_RSRC_NONDFCS = 'N' 
!and [$_where_clause201]
!and [$_where_clause202]
and [$_where_clause_region_county_hist]
and resource_history.ID_RESOURCE_HISTORY = 
(select max (resource_history_max.ID_RESOURCE_HISTORY)
   from resource_history resource_history_max
   WHERE resource_history_max.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
   AND resource_history_max.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
   AND resource_history_max.CD_RSHS_FA_HOME_STATUS = 'FSG'   
   AND resource_history_max.CD_RSHS_CATEGORY = 'O'  ! for Relative adopt home
   AND resource_history_max.IND_RSRC_NONDFCS = 'N'
   and resource_history.ID_RESOURCE = resource_history_max.ID_RESOURCE  !join by resource id to the outer query
) 
End-Select

Begin-Select distinct
sum(resource_history.NBR_RSHS_FACIL_CAPACITY) &_special_grace_app_capacity_ICPC_adopt
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')  !first day of reporting period 
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'FSG' 
AND resource_history.CD_RSHS_CATEGORY = 'J'
AND resource_history.IND_RSRC_NONDFCS = 'N' 
!and [$_where_clause201]
!and [$_where_clause202]
and [$_where_clause_region_county_hist]
and resource_history.ID_RESOURCE_HISTORY = 
(select max (resource_history_max.ID_RESOURCE_HISTORY)
   from resource_history resource_history_max
   WHERE resource_history_max.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
   AND resource_history_max.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
   AND resource_history_max.CD_RSHS_FA_HOME_STATUS = 'FSG'   
   AND resource_history_max.CD_RSHS_CATEGORY = 'J'  ! for ICPC adopt home
   AND resource_history_max.IND_RSRC_NONDFCS = 'N'
   and resource_history.ID_RESOURCE = resource_history_max.ID_RESOURCE  !join by resource id to the outer query
) 
End-Select

Begin-Select distinct
sum(resource_history.NBR_RSHS_FACIL_CAPACITY) &_special_grace_app_capacity_ICPC_foster
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')  !first day of reporting period 
AND resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'FSG' 
AND resource_history.CD_RSHS_CATEGORY = 'I'
AND resource_history.IND_RSRC_NONDFCS = 'N' 
!and [$_where_clause201]
!and [$_where_clause202]
and [$_where_clause_region_county_hist]
and resource_history.ID_RESOURCE_HISTORY = 
(select max (resource_history_max.ID_RESOURCE_HISTORY)
   from resource_history resource_history_max
   WHERE resource_history_max.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 !last day of reporting period
   AND resource_history_max.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') !first day of reporting period
   AND resource_history_max.CD_RSHS_FA_HOME_STATUS = 'FSG'   
   AND resource_history_max.CD_RSHS_CATEGORY = 'I'  ! for ICPC foster home
   AND resource_history_max.IND_RSRC_NONDFCS = 'N'
   and resource_history.ID_RESOURCE = resource_history_max.ID_RESOURCE  !join by resource id to the outer query
) 
End-Select


! Do not use Temp Approved anymore due to MR-075
!Begin-Select distinct
!sum(resource_history.NBR_RSHS_FACIL_CAPACITY) &_temp_app_capacity_foster
!FROM resource_history
!WHERE resource_history.DT_RSHS_EFFECTIVE >= (to_date($_ReportMonth, 'MM/YYYY')) !first day of reporting period 
!AND resource_history.DT_RSHS_EFFECTIVE < (last_day(to_date($_ReportMonth, 'MM/YYYY'))+1) !last day of reporting period
!AND resource_history.CD_RSHS_FA_HOME_STATUS = 'ATA' 
!AND resource_history.CD_RSHS_CATEGORY = 'F'
!AND resource_history.IND_RSRC_NONDFCS = 'N' 
!and [$_where_clause201]
!and [$_where_clause202]
!and [$_where_clause_region_county_hist]
!and resource_history.ID_RESOURCE_HISTORY =
!(select max (resource_history_max.ID_RESOURCE_HISTORY)
!   from resource_history resource_history_max
!   WHERE resource_history_max.DT_RSHS_EFFECTIVE < (last_day(to_date($_ReportMonth, 'MM/YYYY'))+1) !last day of reporting period
!   AND resource_history_max.DT_RSHS_EFFECTIVE >= (to_date($_ReportMonth, 'MM/YYYY')) !first day of reporting period
!   AND resource_history_max.CD_RSHS_FA_HOME_STATUS IN ('ATA')   !use 'ATA' and 'ASA' as appropriate
!   AND resource_history_max.CD_RSHS_CATEGORY = 'F'  !change to L and A as appropriate for Legal Risk and Adoptive homes
!   AND resource_history_max.IND_RSRC_NONDFCS = 'N'
!   and resource_history.ID_RESOURCE = resource_history_max.ID_RESOURCE  !join by resource id to the outer query
!) 
!End-Select

!Begin-Select distinct
!sum(resource_history.NBR_RSHS_FACIL_CAPACITY) &_temp_app_capacity_legal
!FROM resource_history
!WHERE resource_history.DT_RSHS_EFFECTIVE >= (to_date($_ReportMonth, 'MM/YYYY')) !first day of reporting period 
!AND resource_history.DT_RSHS_EFFECTIVE < (last_day(to_date($_ReportMonth, 'MM/YYYY'))+1) !last day of reporting period
!AND resource_history.CD_RSHS_FA_HOME_STATUS = 'ATA' 
!AND resource_history.CD_RSHS_CATEGORY = 'L'
!AND resource_history.IND_RSRC_NONDFCS = 'N' 
!and [$_where_clause201]
!and [$_where_clause202]
!and [$_where_clause_region_county_hist]
!and resource_history.ID_RESOURCE_HISTORY =
!(select max (resource_history_max.ID_RESOURCE_HISTORY)
!   from resource_history resource_history_max
!   WHERE resource_history_max.DT_RSHS_EFFECTIVE < (last_day(to_date($_ReportMonth, 'MM/YYYY'))+1) !last day of reporting period
!   AND resource_history_max.DT_RSHS_EFFECTIVE >= (to_date($_ReportMonth, 'MM/YYYY')) !first day of reporting period
!   AND resource_history_max.CD_RSHS_FA_HOME_STATUS IN ('ATA')   
!   AND resource_history_max.CD_RSHS_CATEGORY = 'L'  !for Legal Risk home
!   AND resource_history_max.IND_RSRC_NONDFCS = 'N'
!   and resource_history.ID_RESOURCE = resource_history_max.ID_RESOURCE  !join by resource id to the outer query
!) 
!End-Select

!Begin-Select distinct
!sum(resource_history.NBR_RSHS_FACIL_CAPACITY) &_temp_app_capacity_adopt
!FROM resource_history
!WHERE resource_history.DT_RSHS_EFFECTIVE >= (to_date($_ReportMonth, 'MM/YYYY')) !first day of reporting period 
!AND resource_history.DT_RSHS_EFFECTIVE < (last_day(to_date($_ReportMonth, 'MM/YYYY'))+1) !last day of reporting period
!AND resource_history.CD_RSHS_FA_HOME_STATUS = 'ATA' 
!AND resource_history.CD_RSHS_CATEGORY = 'A'
!AND resource_history.IND_RSRC_NONDFCS = 'N' 
!--and [$_where_clause201]
!--and [$_where_clause202]
!and [$_where_clause_region_county_hist]
!and resource_history.ID_RESOURCE_HISTORY =
!(select max (resource_history_max.ID_RESOURCE_HISTORY)
!   from resource_history resource_history_max
!   WHERE resource_history_max.DT_RSHS_EFFECTIVE < (last_day(to_date($_ReportMonth, 'MM/YYYY'))+1) !last day of reporting period
!   AND resource_history_max.DT_RSHS_EFFECTIVE >= (to_date($_ReportMonth, 'MM/YYYY')) !first day of reporting period
!   AND resource_history_max.CD_RSHS_FA_HOME_STATUS IN ('ATA')  
!   AND resource_history_max.CD_RSHS_CATEGORY = 'A'  !for Adoptive homes
!   AND resource_history_max.IND_RSRC_NONDFCS = 'N'
!   and resource_history.ID_RESOURCE = resource_history_max.ID_RESOURCE  !join by resource id to the outer query
!) 
!End-Select
End-Procedure

! Calculates Unapproved Homes
BEGIN-PROCEDURE Unapproved-Homes
Begin-SELECT DISTINCT 
count (resource_history.ID_RESOURCE) &_unapproved_homes_foster
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')  ! first day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'AUN'
AND resource_history.CD_RSHS_CATEGORY = 'F' ! for foster home
AND resource_history.IND_RSRC_NONDFCS = 'N'
!and [$_where_clause201]
!and [$_where_clause202]
and [$_where_clause_region_county_hist]
End-Select

Begin-SELECT DISTINCT 
count (resource_history.ID_RESOURCE) &_unapproved_homes_legal
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')  ! first day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'AUN'
AND resource_history.CD_RSHS_CATEGORY = 'L' ! for legal risk home
AND resource_history.IND_RSRC_NONDFCS = 'N'
!and [$_where_clause201]
!and [$_where_clause202]
and [$_where_clause_region_county_hist]
End-Select

Begin-SELECT DISTINCT 
count (resource_history.ID_RESOURCE) &_unapproved_homes_adopt
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') ! first day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'AUN'
AND resource_history.CD_RSHS_CATEGORY = 'A' ! for adopt home
AND resource_history.IND_RSRC_NONDFCS = 'N'
!and [$_where_clause201]
!and [$_where_clause202]
and [$_where_clause_region_county_hist]
End-Select

Begin-SELECT DISTINCT 
count (resource_history.ID_RESOURCE) &_unapproved_homes_Rel_adopt
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') ! first day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'AUN'
AND resource_history.CD_RSHS_CATEGORY = 'D' ! for relative adopt home
AND resource_history.IND_RSRC_NONDFCS = 'N'
!and [$_where_clause201]
!and [$_where_clause202]
and [$_where_clause_region_county_hist]
End-Select

Begin-SELECT DISTINCT 
count (resource_history.ID_RESOURCE) &_unapproved_homes_Rel_foster
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') ! first day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'AUN'
AND resource_history.CD_RSHS_CATEGORY = 'O' ! for relative foster home
AND resource_history.IND_RSRC_NONDFCS = 'N'
!and [$_where_clause201]
!and [$_where_clause202]
and [$_where_clause_region_county_hist]
End-Select

Begin-SELECT DISTINCT 
count (resource_history.ID_RESOURCE) &_unapproved_homes_ICPC_adopt
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') ! first day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'AUN'
AND resource_history.CD_RSHS_CATEGORY = 'J' ! for ICPC adopt home
AND resource_history.IND_RSRC_NONDFCS = 'N'
!and [$_where_clause201]
!and [$_where_clause202]
and [$_where_clause_region_county_hist]
End-Select

Begin-SELECT DISTINCT 
count (resource_history.ID_RESOURCE) &_unapproved_homes_ICPC_foster
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') ! first day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'AUN'
AND resource_history.CD_RSHS_CATEGORY = 'I' ! for ICPC foster home
AND resource_history.IND_RSRC_NONDFCS = 'N'
!and [$_where_clause201]
!and [$_where_clause202]
and [$_where_clause_region_county_hist]
End-Select
END-PROCEDURE

!Calculation for homes in Closed status
Begin-Procedure Closed-Homes
Begin-SELECT DISTINCT 
count (resource_history.ID_RESOURCE) &_closed_homes_foster
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') ! first day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'CSD'
AND resource_history.CD_RSHS_CATEGORY = 'F' ! for foster home
AND resource_history.IND_RSRC_NONDFCS = 'N'
AND CD_RSHS_CLOSURE_RSN is not null
!and [$_where_clause201]
!and [$_where_clause202]
and [$_where_clause_region_county_hist]
End-Select

Begin-SELECT DISTINCT 
count (resource_history.ID_RESOURCE) &_closed_homes_relative_adopt
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') ! first day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'CSD'
AND resource_history.CD_RSHS_CATEGORY = 'D' ! for relative adopt
AND resource_history.IND_RSRC_NONDFCS = 'N'
AND CD_RSHS_CLOSURE_RSN is not null
!and [$_where_clause201]
!and [$_where_clause202]
and [$_where_clause_region_county_hist]
End-Select

Begin-SELECT DISTINCT 
count (resource_history.ID_RESOURCE) &_closed_homes_relative_foster
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') ! first day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'CSD'
AND resource_history.CD_RSHS_CATEGORY = 'O' ! for relative foster home
AND resource_history.IND_RSRC_NONDFCS = 'N'
AND CD_RSHS_CLOSURE_RSN is not null
!and [$_where_clause201]
!and [$_where_clause202]
and [$_where_clause_region_county_hist]
End-Select

Begin-SELECT DISTINCT 
count (resource_history.ID_RESOURCE) &_closed_homes_ICPC_adopt
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') ! first day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'CSD'
AND resource_history.CD_RSHS_CATEGORY = 'J' ! for ICPC adopt home
AND resource_history.IND_RSRC_NONDFCS = 'N'
AND CD_RSHS_CLOSURE_RSN is not null
!and [$_where_clause201]
!and [$_where_clause202]
and [$_where_clause_region_county_hist]
End-Select

Begin-SELECT DISTINCT 
count (resource_history.ID_RESOURCE) &_closed_homes_ICPC_foster
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') ! first day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'CSD'
AND resource_history.CD_RSHS_CATEGORY = 'I' ! for ICPC foster home
AND resource_history.IND_RSRC_NONDFCS = 'N'
AND CD_RSHS_CLOSURE_RSN is not null
!and [$_where_clause201]
!and [$_where_clause202]
and [$_where_clause_region_county_hist]
End-Select

Begin-SELECT DISTINCT 
count (resource_history.ID_RESOURCE) &_closed_homes_legal
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') ! first day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'CSD'
AND resource_history.CD_RSHS_CATEGORY = 'L' !for Legal Risk home
AND resource_history.IND_RSRC_NONDFCS = 'N'
AND CD_RSHS_CLOSURE_RSN is not null
!and [$_where_clause201]
!and [$_where_clause202]
and [$_where_clause_region_county_hist]
End-Select

Begin-SELECT DISTINCT 
count (resource_history.ID_RESOURCE) &_closed_homes_adopt
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') ! first day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'CSD'
AND resource_history.CD_RSHS_CATEGORY = 'A' !for Adoptive home
AND resource_history.IND_RSRC_NONDFCS = 'N'
AND CD_RSHS_CLOSURE_RSN is not null
!and [$_where_clause201]
!and [$_where_clause202]
and [$_where_clause_region_county_hist]
End-Select
End-Procedure




! Calculation for home in waitlist status
Begin-Procedure Waitlist-Homes
Begin-SELECT DISTINCT 
count (resource_history.ID_RESOURCE) &_waitlst_homes_foster
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')  ! first day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'WTL'
AND resource_history.CD_RSHS_CATEGORY = 'F' ! for foster home
AND resource_history.IND_RSRC_NONDFCS = 'N'
!and [$_where_clause201]
!and [$_where_clause202]
and [$_where_clause_region_county_hist]
End-Select

Begin-SELECT DISTINCT 
count (resource_history.ID_RESOURCE) &_waitlst_homes_legal
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')  ! first day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'WTL'
AND resource_history.CD_RSHS_CATEGORY = 'L' !for Legal Risk home
AND resource_history.IND_RSRC_NONDFCS = 'N'
!and [$_where_clause201]
!and [$_where_clause202]
and [$_where_clause_region_county_hist]
End-Select

Begin-SELECT DISTINCT 
count (resource_history.ID_RESOURCE) &_waitlst_homes_adopt
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')  ! first day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'WTL'
AND resource_history.CD_RSHS_CATEGORY = 'A' !for Adoptive home
AND resource_history.IND_RSRC_NONDFCS = 'N'
!and [$_where_clause201]
!and [$_where_clause202]
and [$_where_clause_region_county_hist]
End-Select

Begin-SELECT DISTINCT 
count (resource_history.ID_RESOURCE) &_waitlst_homes_relative_adopt
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') ! first day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'WTL'
AND resource_history.CD_RSHS_CATEGORY = 'D' ! for relative adopt home
AND resource_history.IND_RSRC_NONDFCS = 'N'
!and [$_where_clause201]
!and [$_where_clause202]
and [$_where_clause_region_county_hist]
End-Select

Begin-SELECT DISTINCT 
count (resource_history.ID_RESOURCE) &_waitlst_homes_relative_foster
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') ! first day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'WTL'
AND resource_history.CD_RSHS_CATEGORY = 'O' ! for relative foster home
AND resource_history.IND_RSRC_NONDFCS = 'N'
!and [$_where_clause201]
!and [$_where_clause202]
and [$_where_clause_region_county_hist]
End-Select

Begin-SELECT DISTINCT 
count (resource_history.ID_RESOURCE) &_waitlst_homes_ICPC_adopt
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') ! first day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'WTL'
AND resource_history.CD_RSHS_CATEGORY = 'J' ! for ICPC adopt home
AND resource_history.IND_RSRC_NONDFCS = 'N'
!and [$_where_clause201]
!and [$_where_clause202]
and [$_where_clause_region_county_hist]
End-Select

Begin-SELECT DISTINCT 
count (resource_history.ID_RESOURCE) &_waitlst_homes_ICPC_foster
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') ! first day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'WTL'
AND resource_history.CD_RSHS_CATEGORY = 'I' ! for ICPC foster home
AND resource_history.IND_RSRC_NONDFCS = 'N'
!and [$_where_clause201]
!and [$_where_clause202]
and [$_where_clause_region_county_hist]
End-Select

End-Procedure

Begin-Procedure FH-Closed
Begin-SELECT DISTINCT   
sum (count (distinct resource_history.ID_RESOURCE))  &_close_cnt_foster
FROM resource_history
WHERE resource_history.DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1 ! last day of reporting period
AND resource_history.DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY') ! first day of reporting period
AND resource_history.CD_RSHS_FA_HOME_STATUS = 'CSD'
AND resource_history.CD_RSHS_CATEGORY = 'F' !change to L and A as appropriate for Legal Risk and Adoptive homes
AND resource_history.IND_RSRC_NONDFCS = 'N'
!and [$_where_clause201]
!and [$_where_clause202]
and [$_where_clause_region_county_hist]
group by resource_history.ID_RESOURCE
End-Select
End-Procedure


Begin-Procedure Master_Query
 Do CreateXML_ManifestFile
Begin-Select Distinct
(1) &Dummy
 Alter-Printer Font=4 Point-Size=10    ! [SQR.INI] 4=Arial,proportional
 Print 'Adoption' (15,415,9) Bold 
 Print 'Legal Risk' (15,340,11) Bold 
 Print 'Foster' (15,285,8) Bold 
 Print 'Relative' (15,529,11) Bold 
 Print 'Relative' (15,468,10) Bold 
 Print 'ICPC' (15,603,6) Bold 
 Print 'ICPC' (15,675,6) Bold 
 Print 'Adopt' (28,470,6) Bold 
 Print 'Adopt' (28,601,7) Bold 
 Print 'Foster' (28,533,7) Bold 
 Print 'Foster' (28,674,7) Bold 
 Graphic (43,44,325) Vert-Line 11 
 Graphic (43,43,680) Horz-Line 11 
 Graphic (43,518,324) Vert-Line 11 
 Graphic (43,584,324) Vert-Line 11 
 Graphic (43,725,325) Vert-Line 11 
 Graphic (44,260,325) Vert-Line 10 
 Graphic (44,321,324) Vert-Line 10 
 Graphic (44,457,324) Vert-Line 11 
 Graphic (44,654,324) Vert-Line 11 
 Graphic (45,392,323) Vert-Line 10 
 Print 'Calls for Inquiry' (56,46,27)
 Let #Inq_foster_disp=&_inq_foster_disp
 Print #Inq_foster_disp (57,279) Edit 999999
 Let #Adopt_Foster=&_inq_adop_disp
 Print #Adopt_Foster (57,416) Edit 999999
 Let #Legal_Foster=&_inq_legal_disp
 Print #Legal_Foster (57,352) Edit 999999
 Let #Relative_Adopt=&_inq_Relative_adopt_disp
 Print #Relative_Adopt (57,472) Edit 999999
 Let #Relative_Foster=&_inq_Relative_foster_disp
 Print #Relative_Foster (57,537) Edit 999999
 Let #Relative_Foster=&_inq_ICPC_foster_disp
 Print #Relative_Foster (57,679) Edit 999999
 Let #Relative_Adopt=&_inq_ICPC_adopt_disp
 Print #Relative_Adopt (57,607) Edit 999999
 Graphic (61,44,680) Horz-Line 10 
 Print 'Homes Attended Orientation' (75,46,35)
 Let #att_orient_foster=&_att_orient_foster
 Print #att_orient_foster (76,279) Edit 999999
 Let #att_orient_adopt=&_att_orient_adopt
 Print #att_orient_adopt (76,416) Edit 999999
 Let #att_orient_legal=&_att_orient_legal
 Print #att_orient_legal (76,352) Edit 999999
 Let #att_orient_Relative_adopt=&_att_orient_Relative_adopt
 Print #att_orient_Relative_adopt (76,472) Edit 999999
 Let #att_orient_Relative_foster=&_att_orient_Relative_foster
 Print #att_orient_Relative_foster (76,537) Edit 999999
 Let #att_orient_ICPC_foster=&_att_orient_ICPC_foster
 Print #att_orient_ICPC_foster (76,679) Edit 999999
 Let #att_orient_ICPC_adopt=&_att_orient_ICPC_adopt
 Print #att_orient_ICPC_adopt (76,607) Edit 999999
 Graphic (80,43,680) Horz-Line 10 
 Print 'Homes in Applicant Pre-Service Training' (94,46,45)
 Let #Train_Foster_Disp=&_train_foster_disp
 Print #Train_Foster_Disp (95,279) Edit 999999
 Let #Train_Adopt_Disp=&_train_adopt_disp
 Print #Train_Adopt_Disp (95,416) Edit 999999
 Let #Train_Legal_Disp=&_train_legal_disp
 Print #Train_Legal_Disp (95,352) Edit 999999
 Let #Train_Relative_Adopt_Disp=&_train_relative_adopt_disp
 Print #Train_Relative_Adopt_Disp (95,472) Edit 999999
 Let #Train_Relative_Foster_Disp=&_train_relative_foster_disp
 Print #Train_Relative_Foster_Disp (95,537) Edit 999999
 Let #Train_ICPC_Foster_Disp=&_train_ICPC_foster_disp
 Print #Train_ICPC_Foster_Disp (95,679) Edit 999999
 Let #Train_ICPC_adopt_Disp=&_train_ICPC_adopt_disp
 Print #Train_ICPC_adopt_Disp (95,607) Edit 999999
 Graphic (99,43,681) Horz-Line 10 
 Print 'Homes that attended Pre-Service Training ' (114,46,45)
 Let #attend_train_foster=&_attend_train_foster
 Print #attend_train_foster (115,279) Edit 999999
 Let #attend_train_adopt=&_attend_train_adopt
 Print #attend_train_adopt (115,416) Edit 999999
 Let #attend_train_legal=&_attend_train_legal
 Print #attend_train_legal (115,352) Edit 999999
 Let #attend_train_relative_adopt=&_attend_train_relative_adopt
 Print #attend_train_relative_adopt (115,472) Edit 999999
 Let #attend_train_relative_foster=&_full_approval_relative_foster
 Print #attend_train_relative_foster (115,537) Edit 999999
 Let #attend_train_ICPC_foster=&_attend_train_ICPC_foster
 Print #attend_train_ICPC_foster (115,679) Edit 999999
 Let #attend_train_ICPC_adopt=&_attend_train_ICPC_adopt
 Print #attend_train_ICPC_adopt (115,607) Edit 999999
 Graphic (119,44,679) Horz-Line 10 
 Let #full_approval_foster=&_full_approval_foster
 Print #full_approval_foster (132,279) Edit 999999
 Let #full_approval_adopt=&_full_approval_adopt
 Print #full_approval_adopt (132,416) Edit 999999
 Let #full_approval_legal=&_full_approval_legal
 Print #full_approval_legal (132,352) Edit 999999
 Let #full_approval_relative_adopt=&_full_approval_relative_adopt
 Print #full_approval_relative_adopt (132,472) Edit 999999
 Let #full_approval_relative_foster=&_full_approval_relative_foster
 Print #full_approval_relative_foster (132,537) Edit 999999
 Let #full_approval_ICPC_foster=&_full_approval_ICPC_foster
 Print #full_approval_ICPC_foster (132,679) Edit 999999
 Let #full_approval_ICPC_adopt=&_full_approval_ICPC_adopt
 Print #full_approval_ICPC_adopt (132,607) Edit 999999
 Print 'Homes Approved - Full' (134,46,44)
 Print '# of Beds' (150,46,9)
 Let #full_app_capacity_foster=&_full_app_capacity_foster
 Print #full_app_capacity_foster (150,261) Edit 9999
 Let #full_app_capacity_legal=&_full_app_capacity_legal
 Print #full_app_capacity_legal (150,323) Edit 9999
 Let #full_app_capacity_adopt=&_full_app_capacity_adopt
 Print #full_app_capacity_adopt (150,394) Edit 9999
 Let #full_app_capacity_rel_adopt=&_full_app_capacity_rel_adopt
 Print #full_app_capacity_rel_adopt (150,458) Edit 9999
 Let #full_app_capacity_rel_foster=&_full_app_capacity_rel_foster
 Print #full_app_capacity_rel_foster (150,519) Edit 9999
 Let #full_app_capacity_ICPC_foster=&_full_app_capacity_ICPC_foster
 Print #full_app_capacity_ICPC_foster (150,658) Edit 9999
 Let #full_app_capacity_ICPC_adopt=&_full_app_capacity_ICPC_adopt
 Print #full_app_capacity_ICPC_adopt (150,589) Edit 9999
 Graphic (156,44,679) Horz-Line 10 
 Let #special_approval_foster=&_special_approval_foster
 Print #special_approval_foster (167,279) Edit 999999
 Let #special_approval_adopt=&_special_approval_adopt
 Print #special_approval_adopt (167,416) Edit 999999
 Let #special_approval_legal=&_special_approval_legal
 Print #special_approval_legal (167,352) Edit 999999
 Let #special_approval_relative_adopt=&_special_approval_relative_adopt
 Print #special_approval_relative_adopt (167,472) Edit 999999
 Let #special_approval_relative_foster=&_special_approval_relative_foster
 Print #special_approval_relative_foster (167,537) Edit 999999
 Let #special_approval_ICPC_foster=&_special_approval_ICPC_foster
 Print #special_approval_ICPC_foster (167,679) Edit 999999
 Let #special_approval_ICPC_adopt=&_special_approval_ICPC_adopt
 Print #special_approval_ICPC_adopt (167,607) Edit 999999
 Print 'Homes Approved - Special' (171,46,32)
 Let #special_app_capacity_foster=&_special_app_capacity_foster
 Print #special_app_capacity_foster (183,261) Edit 9999
 Let #special_app_capacity_legal=&_special_app_capacity_legal
 Print #special_app_capacity_legal (183,323) Edit 9999
 Let #special_app_capacity_adopt=&_special_app_capacity_adopt
 Print #special_app_capacity_adopt (183,394) Edit 9999
 Let #special_app_capacity_rel_adopt=&_special_app_capacity_rel_adopt
 Print #special_app_capacity_rel_adopt (183,458) Edit 9999
 Let #special_app_capacity_rel_foster=&_special_app_capacity_rel_foster
 Print #special_app_capacity_rel_foster (183,520) Edit 9999
 Let #special_app_capacity_ICPC_foster=&_special_app_capacity_ICPC_foster
 Print #special_app_capacity_ICPC_foster (183,658) Edit 9999
 Let #special_app_capacity_ICPC_adopt=&_special_app_capacity_ICPC_adopt
 Print #special_app_capacity_ICPC_adopt (183,589) Edit 9999
 Print '# of Beds' (184,46,10)
 Graphic (190,44,679) Horz-Line 15 
 Let #full_approval_foster=&_full_approval_foster
 Let #special_approval_foster=&_special_approval_foster
 Let #total_approval_foster=#full_approval_foster + #special_approval_foster
 Print #total_approval_foster (205,277) Edit 999999 Bold 
 Let #full_approval_adopt=&_full_approval_adopt
 Let #special_approval_adopt=&_special_approval_adopt
 Let #total_approval_adopt=#full_approval_adopt + #special_approval_adopt
 Print #total_approval_adopt (205,414) Edit 999999 Bold 
 Let #full_approval_legal=&_full_approval_legal
 Let #special_approval_legal=&_special_approval_legal
 Let #total_approval_legal=#full_approval_legal + #special_approval_legal
 Print #total_approval_legal (205,350) Edit 999999 Bold 
 Let #full_approval_relative_adopt=&_full_approval_relative_adopt
 Let #special_approval_relative_adopt=&_special_approval_relative_adopt
 Let #total_approval_relative_adopt=#full_approval_relative_adopt + #special_approval_relative_adopt
 Print #total_approval_relative_adopt (205,471) Edit 999999 Bold 
 Let #full_approval_relative_foster=&_full_approval_relative_foster
 Let #special_approval_relative_foster=&_special_approval_relative_foster
 Let #total_approval_relative_foster=#full_approval_relative_foster + #special_approval_relative_foster
 Print #total_approval_relative_foster (205,535) Edit 999999 Bold 
 Let #full_approval_ICPC_foster=&_full_approval_ICPC_foster
 Let #special_approval_ICPC_foster=&_special_approval_ICPC_foster
 Let #total_approval_ICPC_foster=#full_approval_ICPC_foster + #special_approval_ICPC_foster
 Print #total_approval_ICPC_foster (205,678) Edit 999999 Bold 
 Let #full_approval_ICPC_adopt=&_full_approval_ICPC_adopt
 Let #special_approval_ICPC_adopt=&_special_approval_ICPC_adopt
 Let #total_approval_ICPC_adopt=#full_approval_ICPC_adopt + #special_approval_ICPC_adopt
 Print #total_approval_ICPC_adopt (205,605) Edit 999999 Bold 
 Print 'Total Full/Special Homes Approved' (206,58,40) Bold 
 Graphic (210,43,680) Horz-Line 15 
 Print 'Full Approval 30 Day Grace' (225,46,33)
 Let #full_grace_approval_foster=&_full_grace_approval_foster
 Print #full_grace_approval_foster (226,279) Edit 999999
 Let #full_grace_approval_legal=&_full_grace_approval_legal
 Print #full_grace_approval_legal (226,352) Edit 999999
 Let #full_grace_approval_adopt=&_full_grace_approval_adopt
 Print #full_grace_approval_adopt (226,416) Edit 999999
 Let #full_grace_approval_relative_adopt=&_full_grace_approval_relative_adopt
 Print #full_grace_approval_relative_adopt (226,472) Edit 999999
 Let #full_grace_approval_relative_foster=&_full_grace_approval_relative_foster
 Print #full_grace_approval_relative_foster (226,537) Edit 999999
 Let #full_grace_approval_ICPC_foster=&_full_grace_approval_ICPC_foster
 Print #full_grace_approval_ICPC_foster (226,679) Edit 999999
 Let #full_grace_approval_ICPC_adopt=&_full_grace_approval_ICPC_adopt
 Print #full_grace_approval_ICPC_adopt (226,607) Edit 999999
 Print '# of Beds' (240,47,10)
 Let #full_grace_app_capacity_foster=&_full_grace_app_capacity_foster
 Print #full_grace_app_capacity_foster (241,261) Edit 9999
 Let #full_grace_app_capacity_legal=&_full_grace_app_capacity_legal
 Print #full_grace_app_capacity_legal (241,323) Edit 9999
 Let #full_grace_app_capacity_adopt=&_full_grace_app_capacity_adopt
 Print #full_grace_app_capacity_adopt (241,394) Edit 9999
 Let #full_grace_app_capacity_rel_adopt=&_full_grace_app_capacity_rel_adopt
 Print #full_grace_app_capacity_rel_adopt (241,459) Edit 9999
 Let #full_grace_app_capacity_rel_foster=&_full_grace_app_capacity_rel_foster
 Print #full_grace_app_capacity_rel_foster (241,521) Edit 9999
 Let #full_grace_app_capacity_ICPC_foster=&_full_grace_app_capacity_ICPC_foster
 Print #full_grace_app_capacity_ICPC_foster (241,658) Edit 9999
 Let #full_grace_app_capacity_ICPC_adopt=&_full_grace_app_capacity_ICPC_adopt
 Print #full_grace_app_capacity_ICPC_adopt (241,589) Edit 9999
 Graphic (245,43,679) Horz-Line 10 
 Let #special_grace_approval_foster=&_special_grace_approval_foster
 Print #special_grace_approval_foster (259,279) Edit 999999
 Let #special_grace_approval_legal=&_special_grace_approval_legal
 Print #special_grace_approval_legal (259,352) Edit 999999
 Let #special_grace_approval_adopt=&_special_grace_approval_adopt
 Print #special_grace_approval_adopt (259,416) Edit 999999
 Print 'Special Approval 30 Day Grace' (259,46,29)
 Let #special_grace_approval_rel_adopt=&_special_grace_approval_rel_adopt
 Print #special_grace_approval_rel_adopt (259,472) Edit 999999
 Let #special_grace_approval_rel_foster=&_special_grace_approval_rel_foster
 Print #special_grace_approval_rel_foster (259,537) Edit 999999
 Let #special_grace_approval_ICPC_foster=&_special_grace_approval_ICPC_foster
 Print #special_grace_approval_ICPC_foster (259,679) Edit 999999
 Let #special_grace_approval_ICPC_adopt=&_special_grace_approval_ICPC_adopt
 Print #special_grace_approval_ICPC_adopt (259,607) Edit 999999
 Let #special_grace_app_capacity_foster=&_special_grace_app_capacity_foster
 Print #special_grace_app_capacity_foster (277,261) Edit 9999
 Let #special_grace_app_capacity_legal=&_special_grace_app_capacity_legal
 Print #special_grace_app_capacity_legal (277,323) Edit 9999
 Let #special_grace_app_capacity_adopt=&_special_grace_app_capacity_adopt
 Print #special_grace_app_capacity_adopt (277,394) Edit 9999
 Print '# of Beds' (277,47,10)
 Let #special_grace_app_capacity_rel_adopt=&_special_grace_app_capacity_rel_adopt
 Print #special_grace_app_capacity_rel_adopt (277,459) Edit 9999
 Let #special_grace_app_capacity_rel_foster=&_special_grace_app_capacity_rel_foster
 Print #special_grace_app_capacity_rel_foster (277,521) Edit 9999
 Let #special_grace_app_capacity_ICPC_foster=&_special_grace_app_capacity_ICPC_foster
 Print #special_grace_app_capacity_ICPC_foster (277,658) Edit 9999
 Let #special_grace_app_capacity_ICPC_adopt=&_special_grace_app_capacity_ICPC_adopt
 Print #special_grace_app_capacity_ICPC_adopt (277,589) Edit 9999
 Graphic (282,44,680) Horz-Line 15 
 Let #full_grace_approval_foster=&_full_grace_approval_foster
 Let #special_grace_approval_foster=&_special_grace_approval_foster
 Let #total_grace_foster=#full_grace_approval_foster + #special_grace_approval_foster
 Print #total_grace_foster (298,277) Edit 999999 Bold 
 Let #full_grace_approval_legal=&_full_grace_approval_legal
 Let #special_grace_approval_legal=&_special_grace_approval_legal
 Let #total_grace_legal=#full_grace_approval_legal + #special_grace_approval_legal
 Print #total_grace_legal (298,350) Edit 999999 Bold 
 Let #full_grace_approval_adopt=&_full_grace_approval_adopt
 Let #special_grace_approval_adopt=&_special_grace_approval_adopt
 Let #total_grace_adopt=#full_grace_approval_adopt + #special_grace_approval_adopt
 Print #total_grace_adopt (298,414) Edit 999999 Bold 
 Let #full_grace_approval_relative_adopt=&_full_grace_approval_relative_adopt
 Let #special_grace_approval_rel_adopt=&_special_grace_approval_rel_adopt
 Let #total_grace_relative_adopt=#full_grace_approval_relative_adopt + #special_grace_approval_rel_adopt
 Print #total_grace_relative_adopt (298,471) Edit 999999 Bold 
 Let #full_grace_approval_relative_foster=&_full_grace_approval_relative_foster
 Let #special_grace_approval_rel_foster=&_special_grace_approval_rel_foster
 Let #total_grace_relative_foster=#full_grace_approval_relative_foster + #special_grace_approval_rel_foster
 Print #total_grace_relative_foster (298,535) Edit 999999 Bold 
 Let #full_grace_approval_ICPC_foster=&_full_grace_approval_ICPC_foster
 Let #special_grace_approval_ICPC_foster=&_special_grace_approval_ICPC_foster
 Let #total_grace_ICPC_foster=#full_grace_approval_ICPC_foster + #special_grace_approval_ICPC_foster
 Print #total_grace_ICPC_foster (298,678) Edit 999999 Bold 
 Let #full_grace_approval_ICPC_adopt=&_full_grace_approval_ICPC_adopt
 Let #special_grace_approval_ICPC_adopt=&_special_grace_approval_ICPC_adopt
 Let #total_grace_ICPC_adopt=#full_grace_approval_ICPC_adopt + #special_grace_approval_ICPC_adopt
 Print #total_grace_ICPC_adopt (298,605) Edit 999999 Bold 
 Print 'Total Full/Special Approval 30 Day Grace' (299,58,54) Bold 
 Graphic (305,43,680) Horz-Line 15 
 Print 'Homes Unapproved' (318,46,34)
 Let #unapproved_homes_legal=&_unapproved_homes_legal
 Print #unapproved_homes_legal (320,352) Edit 999999
 Let #unapproved_homes_adopt=&_unapproved_homes_adopt
 Print #unapproved_homes_adopt (320,416) Edit 999999
 Let #unapproved_homes_foster=&_unapproved_homes_foster
 Print #unapproved_homes_foster (320,279) Edit 999999
 Let #unapproved_homes_Rel_adopt=&_unapproved_homes_Rel_adopt
 Print #unapproved_homes_Rel_adopt (320,472) Edit 999999
 Let #unapproved_homes_Rel_foster=&_unapproved_homes_Rel_foster
 Print #unapproved_homes_Rel_foster (320,537) Edit 999999
 Let #unapproved_homes_ICPC_foster=&_unapproved_homes_ICPC_foster
 Print #unapproved_homes_ICPC_foster (320,679) Edit 999999
 Let #unapproved_homes_ICPC_adopt=&_unapproved_homes_ICPC_adopt
 Print #unapproved_homes_ICPC_adopt (320,607) Edit 999999
 Graphic (326,43,681) Horz-Line 10 
 Let #waitlst_homes_adopt=&_waitlst_homes_adopt
 Print #waitlst_homes_adopt (341,416) Edit 999999
 Let #waitlst_homes_legal=&_waitlst_homes_legal
 Print #waitlst_homes_legal (341,352) Edit 999999
 Let #waitlst_homes_foster=&_waitlst_homes_foster
 Print #waitlst_homes_foster (341,279) Edit 999999
 Let #waitlst_homes_relative_adopt=&_waitlst_homes_relative_adopt
 Print #waitlst_homes_relative_adopt (341,472) Edit 999999
 Let #waitlst_homes_relative_foster=&_waitlst_homes_relative_foster
 Print #waitlst_homes_relative_foster (341,537) Edit 999999
 Let #waitlst_homes_ICPC_foster=&_waitlst_homes_ICPC_foster
 Print #waitlst_homes_ICPC_foster (341,679) Edit 999999
 Let #waitlst_homes_ICPC_adopt=&_waitlst_homes_ICPC_adopt
 Print #waitlst_homes_ICPC_adopt (341,607) Edit 999999
 Print 'Homes Waitlisted ' (342,46,21)
 Graphic (349,42,681) Horz-Line 11 
 Let #closed_homes_adopt=&_closed_homes_adopt
 Print #closed_homes_adopt (362,416) Edit 999999
 Let #closed_homes_legal=&_closed_homes_legal
 Print #closed_homes_legal (362,352) Edit 999999
 Print 'Homes Closed' (362,47,21)
 Let #closed_homes_foster=&_closed_homes_foster
 Print #closed_homes_foster (362,279) Edit 999999
 Let #closed_homes_relative_adopt=&_closed_homes_relative_adopt
 Print #closed_homes_relative_adopt (362,472) Edit 999999
 Let #closed_homes_relative_foster=&_closed_homes_relative_foster
 Print #closed_homes_relative_foster (362,537) Edit 999999
 Let #closed_homes_ICPC_foster=&_closed_homes_ICPC_foster
 Print #closed_homes_ICPC_foster (362,679) Edit 999999
 Let #closed_homes_ICPC_adopt=&_closed_homes_ICPC_adopt
 Print #closed_homes_ICPC_adopt (362,607) Edit 999999
 Graphic (368,44,680) Horz-Line 11 
 Next-Listing  SkipLines=6 Need=368
From  CAPS.RESOURCE_HISTORY
End-Select
 Next-Listing
!  Place the closing tag(s) into the XML file
   Write 1 from '<output>'
   Write 1 from '</output>'
   Close 1
End-Procedure

Begin-Procedure Master_Query_5
begin-SELECT 
(count( RESOURCE_HISTORY.ID_RESOURCE )) &fclosecnt
FROM 
    RESOURCE_HISTORY, 
    CFACLOSE
WHERE
    RESOURCE_HISTORY.CD_RSHS_CLOSURE_RSN = CFACLOSE.CODE
  AND CD_RSHS_FA_HOME_STATUS = 'CSD' AND 
    CD_RSHS_CATEGORY = 'F' AND 
    IND_RSRC_NONDFCS = 'N' AND 
    (RESOURCE_HISTORY.DT_RSHS_EFFECTIVE < (to_date($_EndDate, 'MM/DD/YYYY') + 1) AND 
    RESOURCE_HISTORY.DT_RSHS_EFFECTIVE >= (to_date($_StartDate,'MM/DD/YYYY'))) 
   ! And [$_where_clause201]
 !And [$_where_clause202]
and [$_where_clause_region_county_hist]
End-Select
if IsNull(&fclosecnt) or &fclosecnt = 0 
 Let $dispText = 'No results are available'
End-If
Begin-Select
('Foster Home Closures') &dispTextName
 Alter-Printer Font=4 Point-Size=10    ! [SQR.INI] 4=Arial,proportional
 Print &dispTextName (10,43,20) Underline  Bold 
 Let $_dispTextCnt=$dispText
 Print $_dispTextCnt (31,106,46)
 Next-Listing  SkipLines=2 Need=33
From 
 dual
End-Select
 Next-Listing
End-Procedure

Begin-Procedure Master_Query_2
 Move 0 To #5ROW_COUNT
 Move 0 To #CloseCountFoster
Begin-Select
(count (resource_history.ID_RESOURCE)) &close_cnt_foster
 Alter-Printer Font=4 Point-Size=10    ! [SQR.INI] 4=Arial,proportional
DECODE &Master_Query_2_DECODE (17,47,50) Wrap 50 2 line-height=12 Keep-Top on= 
 Print &close_cnt_foster (17,361) Edit 9999999na
 Add &close_cnt_foster To #CloseCountFoster
 Add 1 To #5ROW_COUNT
 Next-Listing  Need=22
From  CAPS.RESOURCE_HISTORY, CAPS.CFACLOSE
      Where CAPS.RESOURCE_HISTORY.CD_RSHS_CLOSURE_RSN = CAPS.CFACLOSE.CODE
 And DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1
 And DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')
 And CD_RSHS_FA_HOME_STATUS = 'CSD'
 And CD_RSHS_CATEGORY = 'F'
 And IND_RSRC_NONDFCS = 'N'
 And [$_where_clause_region_county_hist]
Group By DECODE
Order By DECODE
End-Select
 Next-Listing
 Next-Listing  Need=20
 If #5ROW_COUNT > 0
 Graphic (3,358,42) Horz-Line 10 
 Position (4,1)
 Alter-Printer Font=4 Point-Size=10    ! [SQR.INI] 4=Arial,proportional
  Print 'Total Closures'  (19,251) Bold 
  Print #CloseCountFoster (20,352) Edit 999999999na
 End-If
 Next-Listing
!! Do DisplayCounts1
End-Procedure

Begin-Procedure Master_Query_6

begin-select
(count( RESOURCE_HISTORY.ID_RESOURCE )) &lclosecnt
FROM 
    RESOURCE_HISTORY, 
    CFACLOSE
WHERE
    RESOURCE_HISTORY.CD_RSHS_CLOSURE_RSN = CFACLOSE.CODE
  AND     DT_RSHS_EFFECTIVE < (to_date($_EndDate, 'MM/DD/YYYY') + 1) AND 
    DT_RSHS_EFFECTIVE >= (to_date($_StartDate,'MM/DD/YYYY')) AND 
    CD_RSHS_FA_HOME_STATUS = 'CSD' AND 
    CD_RSHS_CATEGORY = 'L' AND 
    IND_RSRC_NONDFCS = 'N' 
!And [$_where_clause201]
! And [$_where_clause202]
and [$_where_clause_region_county_hist]

End-select
if IsNull(&lclosecnt) or &lclosecnt = 0 
 Let $dispTextlegal = 'No results are available'
End-If


Begin-Select
('Legal Risk Closures') &legalClosureHeader
 Alter-Printer Font=4 Point-Size=10    ! [SQR.INI] 4=Arial,proportional
 Print &legalClosureHeader (17,43,36) Underline  Bold 
 Let $_dispTextlegal=$dispTextlegal
 Print $_dispTextlegal (39,119,38)
 Next-Listing  Need=39
From 
 dual
End-Select
 Next-Listing
End-Procedure

Begin-Procedure Master_Query_3
 Move 0 To #9ROW_COUNT
 Move 0 To #CloseCountLegal
Begin-Select
(count( RESOURCE_HISTORY.ID_RESOURCE )) &close_cnt_legal
 Alter-Printer Font=4 Point-Size=10    ! [SQR.INI] 4=Arial,proportional
DECODE &Master_Query_3_DECODE (16,46,50) Wrap 50 2 line-height=12 Keep-Top on= 
 Print &close_cnt_legal (16,360) Edit 9999999na
 Add &close_cnt_legal To #CloseCountLegal
 Add 1 To #9ROW_COUNT
 Next-Listing  Need=22
From  CAPS.RESOURCE_HISTORY, CAPS.CFACLOSE
      Where CAPS.RESOURCE_HISTORY.CD_RSHS_CLOSURE_RSN = CAPS.CFACLOSE.CODE
 And DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1
 And DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')
 And CD_RSHS_FA_HOME_STATUS = 'CSD'
 And CD_RSHS_CATEGORY = 'L'
 And IND_RSRC_NONDFCS = 'N'
 And [$_where_clause_region_county_hist]
Group By DECODE
Order By DECODE
End-Select
 Next-Listing
 Next-Listing  Need=20
 If #9ROW_COUNT > 0
 Graphic (3,358,40) Horz-Line 10 
 Position (4,1)
 Alter-Printer Font=4 Point-Size=10    ! [SQR.INI] 4=Arial,proportional
  Print #CloseCountLegal (20,350) Edit 999999999na
  Print 'Total Closures'  (20,254) Bold 
 End-If
 Next-Listing
End-Procedure

Begin-Procedure Master_Query_7
Begin-Select
(count( RESOURCE_HISTORY.ID_RESOURCE )) &aclosecnt
FROM 
    RESOURCE_HISTORY, 
    CFACLOSE
WHERE
    RESOURCE_HISTORY.CD_RSHS_CLOSURE_RSN = CFACLOSE.CODE
  AND     DT_RSHS_EFFECTIVE < (to_date($_EndDate, 'MM/DD/YYYY') + 1) AND 
    DT_RSHS_EFFECTIVE >= (to_date($_StartDate,'MM/DD/YYYY')) AND 
    CD_RSHS_FA_HOME_STATUS = 'CSD' AND 
    CD_RSHS_CATEGORY = 'A' AND 
    IND_RSRC_NONDFCS = 'N'  
and [$_where_clause_region_county_hist]

End-Select
if IsNull(&aclosecnt) or (&aclosecnt = 0)
 Let $dispTextadopt = 'No results are available'
End-If

Begin-Select
('Adoption Closures') &adoptionclosureHeader
 Alter-Printer Font=4 Point-Size=10    ! [SQR.INI] 4=Arial,proportional
 Print &adoptionclosureHeader (17,43,29) Underline  Bold 
 Let $_dispTextadopt=$dispTextadopt
 Print $_dispTextadopt (39,119,26)
 Next-Listing  Need=39
From 
 dual
End-Select
 Next-Listing
End-Procedure

Begin-Procedure Master_Query_4
 Move 0 To #16ROW_COUNT
 Move 0 To #CloseCountAdopt
Begin-Select
(count( RESOURCE_HISTORY.ID_RESOURCE )) &close_cnt_adopt
 Alter-Printer Font=4 Point-Size=10    ! [SQR.INI] 4=Arial,proportional
 Print &close_cnt_adopt (15,360) Edit 9999999na
DECODE &Master_Query_4_DECODE (15,46,50) Wrap 50 2 line-height=12 Keep-Top on= 
 Add &close_cnt_adopt To #CloseCountAdopt
 Add 1 To #16ROW_COUNT
 Next-Listing  Need=22
From  CAPS.RESOURCE_HISTORY, CAPS.CFACLOSE
      Where CAPS.CFACLOSE.CODE = CAPS.RESOURCE_HISTORY.CD_RSHS_CLOSURE_RSN
 And DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1
 And DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')
 And CD_RSHS_FA_HOME_STATUS = 'CSD'
 And CD_RSHS_CATEGORY = 'A'
 And IND_RSRC_NONDFCS = 'N'
 And [$_where_clause_region_county_hist]
Group By DECODE
Order By DECODE
End-Select
 Next-Listing
 Next-Listing  Need=21
 If #16ROW_COUNT > 0
 Graphic (4,358,44) Horz-Line 10 
 Position (5,1)
 Alter-Printer Font=4 Point-Size=10    ! [SQR.INI] 4=Arial,proportional
  Print 'Total Closures'  (20,253) Bold 
  Print #CloseCountAdopt (21,350) Edit 999999999na
 End-If
 Next-Listing
End-Procedure

Begin-Procedure Master_Query_9
Begin-Select
(count( RESOURCE_HISTORY.ID_RESOURCE )) &dclosecnt
FROM 
    RESOURCE_HISTORY, 
    CFACLOSE
WHERE
    RESOURCE_HISTORY.CD_RSHS_CLOSURE_RSN = CFACLOSE.CODE
  AND     DT_RSHS_EFFECTIVE < (to_date($_EndDate, 'MM/DD/YYYY') + 1) AND 
    DT_RSHS_EFFECTIVE >= (to_date($_StartDate,'MM/DD/YYYY')) AND 
    CD_RSHS_FA_HOME_STATUS = 'CSD' AND 
    CD_RSHS_CATEGORY = 'D' AND 
    IND_RSRC_NONDFCS = 'N'  
and [$_where_clause_region_county_hist]

End-Select
if IsNull(&dclosecnt) or (&dclosecnt = 0)
 Let $dispTextreladopt = 'No results are available'
End-If

Begin-Select
('Relative Adoption Closures') &reladoptionclosureHeader
 Alter-Printer Font=4 Point-Size=10    ! [SQR.INI] 4=Arial,proportional
 Print &reladoptionclosureHeader (14,43,29) Underline  Bold 
 Let $_dispTextreladopt=$dispTextreladopt
 Print $_dispTextreladopt (32,121,26)
 Next-Listing  Need=32
From 
 dual
End-Select
 Next-Listing
End-Procedure

Begin-Procedure Master_Query_8
 Move 0 To #20ROW_COUNT
 Move 0 To #ClosCntRelAdopt
Begin-Select
(count (RESOURCE_HISTORY.ID_RESOURCE)) &close_cnt_rel_adopt
 Alter-Printer Font=4 Point-Size=10    ! [SQR.INI] 4=Arial,proportional
DECODE &Master_Query_8_DECODE (15,50,50) Wrap 50 2 line-height=12 Keep-Top
 Print &close_cnt_rel_adopt (15,359) Edit 9999999na
 Add &close_cnt_rel_adopt To #ClosCntRelAdopt
 Add 1 To #20ROW_COUNT
 Next-Listing  Need=22
From  CAPS.RESOURCE_HISTORY, CAPS.CFACLOSE
      Where CAPS.CFACLOSE.CODE = CAPS.RESOURCE_HISTORY.CD_RSHS_CLOSURE_RSN
 And DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1
 And DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')
 And CD_RSHS_FA_HOME_STATUS = 'CSD'
 And CD_RSHS_CATEGORY = 'D'
 And IND_RSRC_NONDFCS = 'N'
 And [$_where_clause_region_county_hist]
Group By DECODE
Order By DECODE
End-Select
 Next-Listing
 Next-Listing  Need=19
 If #20ROW_COUNT > 0
 Graphic (4,360,42) Horz-Line 10 
 Position (5,1)
 Alter-Printer Font=4 Point-Size=10    ! [SQR.INI] 4=Arial,proportional
  Print #ClosCntRelAdopt (19,348) Edit 999999999na
  Print 'Total Closures'  (19,252) Bold 
 End-If
 Next-Listing
End-Procedure

Begin-Procedure Master_Query_11
Begin-Select
(count( RESOURCE_HISTORY.ID_RESOURCE )) &oclosecnt
FROM 
    RESOURCE_HISTORY, 
    CFACLOSE
WHERE
    RESOURCE_HISTORY.CD_RSHS_CLOSURE_RSN = CFACLOSE.CODE
  AND     DT_RSHS_EFFECTIVE < (to_date($_EndDate, 'MM/DD/YYYY') + 1) AND 
    DT_RSHS_EFFECTIVE >= (to_date($_StartDate,'MM/DD/YYYY')) AND 
    CD_RSHS_FA_HOME_STATUS = 'CSD' AND 
    CD_RSHS_CATEGORY = 'O' AND 
    IND_RSRC_NONDFCS = 'N'  
and [$_where_clause_region_county_hist]

End-Select
if IsNull(&oclosecnt) or (&oclosecnt = 0)
 Let $dispTextrelfoster = 'No results are available'
End-If

Begin-Select

('Relative Foster Closures') &relfosterclosureHeader
 Alter-Printer Font=4 Point-Size=10    ! [SQR.INI] 4=Arial,proportional
 Print &relfosterclosureHeader (17,38,29) Underline  Bold 
 Let $_dispTextrelfoster=$dispTextrelfoster
 Print $_dispTextrelfoster (36,122,26)
 Next-Listing  Need=36
From 
 dual
End-Select
 Next-Listing
End-Procedure

Begin-Procedure Master_Query_10
 Move 0 To #29ROW_COUNT
 Move 0 To #closecntrelfoster
Begin-Select
(count( RESOURCE_HISTORY.ID_RESOURCE )) &close_cnt_rel_foster
 Alter-Printer Font=4 Point-Size=10    ! [SQR.INI] 4=Arial,proportional
DECODE &Master_Query_10_DECODE (15,50,50) Wrap 50 2 line-height=12 Keep-Top
 Print &close_cnt_rel_foster (15,360) Edit 9999999na
 Add &close_cnt_rel_foster To #closecntrelfoster
 Add 1 To #29ROW_COUNT
 Next-Listing  Need=22
From  CAPS.RESOURCE_HISTORY, CAPS.CFACLOSE
      Where CAPS.CFACLOSE.CODE = CAPS.RESOURCE_HISTORY.CD_RSHS_CLOSURE_RSN
 And DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1
 And DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')
 And CD_RSHS_FA_HOME_STATUS = 'CSD'
 And CD_RSHS_CATEGORY = 'O'
 And IND_RSRC_NONDFCS = 'N'
 And [$_where_clause_region_county_hist]
Group By DECODE
Order By DECODE Desc
End-Select
 Next-Listing
 Next-Listing  Need=19
 If #29ROW_COUNT > 0
 Graphic (4,359,42) Horz-Line 10 
 Position (5,1)
 Alter-Printer Font=4 Point-Size=10    ! [SQR.INI] 4=Arial,proportional
  Print #closecntrelfoster (19,349) Edit 999999999na
  Print 'Total Closures'  (19,250) Bold 
 End-If
 Next-Listing
End-Procedure

Begin-Procedure Master_Query_13
Begin-Select
(count( RESOURCE_HISTORY.ID_RESOURCE )) &jclosecnt
FROM 
    RESOURCE_HISTORY, 
    CFACLOSE
WHERE
    RESOURCE_HISTORY.CD_RSHS_CLOSURE_RSN = CFACLOSE.CODE
  AND     DT_RSHS_EFFECTIVE < (to_date($_EndDate, 'MM/DD/YYYY') + 1) AND 
    DT_RSHS_EFFECTIVE >= (to_date($_StartDate,'MM/DD/YYYY')) AND 
    CD_RSHS_FA_HOME_STATUS = 'CSD' AND 
    CD_RSHS_CATEGORY = 'J' AND 
    IND_RSRC_NONDFCS = 'N'  
and [$_where_clause_region_county_hist]

End-Select
if IsNull(&jclosecnt) or (&jclosecnt = 0)
 Let $dispTexticpcadopt = 'No results are available'
End-If

Begin-Select
('ICPC Adopt Closures') &icpcadoptionclosureHeader
 Alter-Printer Font=4 Point-Size=10    ! [SQR.INI] 4=Arial,proportional
 Print &icpcadoptionclosureHeader (11,38,29) Underline  Bold 
 Let $_dispTexticpcadopt=$dispTexticpcadopt
 Print $_dispTexticpcadopt (29,122,26)
 Next-Listing  SkipLines=1 Need=30
From 
 dual
End-Select
 Next-Listing
End-Procedure

Begin-Procedure Master_Query_12
 Move 0 To #36ROW_COUNT
 Move 0 To #closecnticpcadopt
Begin-Select
(count( RESOURCE_HISTORY.ID_RESOURCE )) &close_cnt_icpc_adopt
 Alter-Printer Font=4 Point-Size=10    ! [SQR.INI] 4=Arial,proportional
DECODE &Master_Query_12_DECODE (13,50,50) Wrap 50 2 line-height=12 Keep-Top
 Print &close_cnt_icpc_adopt (13,362) Edit 9999999na
 Add &close_cnt_icpc_adopt To #closecnticpcadopt
 Add 1 To #36ROW_COUNT
 Next-Listing  Need=22
From  CAPS.CFACLOSE, CAPS.RESOURCE_HISTORY
      Where CAPS.CFACLOSE.CODE = CAPS.RESOURCE_HISTORY.CD_RSHS_CLOSURE_RSN
 And DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1
 And DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')
 And CD_RSHS_FA_HOME_STATUS = 'CSD'
 And CD_RSHS_CATEGORY = 'J'
 And IND_RSRC_NONDFCS = 'N'
 And [$_where_clause_region_county_hist]
Group By DECODE
Order By DECODE Desc
End-Select
 Next-Listing
 Next-Listing  Need=20
 If #36ROW_COUNT > 0
 Graphic (5,359,42) Horz-Line 10 
 Position (6,1)
 Alter-Printer Font=4 Point-Size=10    ! [SQR.INI] 4=Arial,proportional
  Print #closecnticpcadopt (20,351) Edit 999999999na
  Print 'Total Closures'  (20,251) Bold 
 End-If
 Next-Listing
End-Procedure

Begin-Procedure Master_Query_15
Begin-Select
('ICPC Foster Closures') &icpcfosterclosureHeader
 Alter-Printer Font=4 Point-Size=10    ! [SQR.INI] 4=Arial,proportional
 Print &icpcfosterclosureHeader (16,38,29) Underline  Bold 
 Let $_dispTexticpcfoster=$dispTexticpcfoster
 Print $_dispTexticpcfoster (37,123,26)
 Next-Listing  Need=37
From 
 dual
End-Select
 Next-Listing
End-Procedure

Begin-Procedure Master_Query_14
 Move 0 To #41ROW_COUNT
 Move 0 To #closecnticpcfoster
Begin-Select
(count( RESOURCE_HISTORY.ID_RESOURCE )) &close_cnt_icpc_foster
 Alter-Printer Font=4 Point-Size=10    ! [SQR.INI] 4=Arial,proportional
DECODE &Master_Query_14_DECODE (17,50,50) Wrap 50 2 line-height=12 Keep-Top
 Print &close_cnt_icpc_foster (17,360) Edit 9999999na
 Add &close_cnt_icpc_foster To #closecnticpcfoster
 Add 1 To #41ROW_COUNT
 Next-Listing  Need=22
From  CAPS.CFACLOSE, CAPS.RESOURCE_HISTORY
      Where CAPS.RESOURCE_HISTORY.CD_RSHS_CLOSURE_RSN = CAPS.CFACLOSE.CODE
 And DT_RSHS_EFFECTIVE < to_date($_EndDate, 'MM/DD/YYYY') + 1
 And DT_RSHS_EFFECTIVE >= to_date($_StartDate,'MM/DD/YYYY')
 And CD_RSHS_FA_HOME_STATUS = 'CSD'
 And CD_RSHS_CATEGORY = 'I'
 And IND_RSRC_NONDFCS = 'N'
 And [$_where_clause_region_county_hist]
Group By DECODE
Order By DECODE Desc
End-Select
 Next-Listing
 Next-Listing  Need=19
 If #41ROW_COUNT > 0
 Graphic (3,357,44) Horz-Line 10 
 Position (4,1)
 Alter-Printer Font=4 Point-Size=10    ! [SQR.INI] 4=Arial,proportional
  Print #closecnticpcfoster (19,349) Edit 999999999na
  Print 'Total Closures'  (17,252) Bold 
 End-If
 Next-Listing
End-Procedure

Begin-Procedure CreateXML_ManifestFile
! Open the XML file.
 Let $_XML_Var='SQROutput.xml'
 Open $_XML_Var as 1 for-writing record=32767:vary
! Place the elements of the DTD.
 Let $preamble = '<?xml version="1.0" encoding="ISO-8859-1"?>'
 Write 1 from $preamble
End-Procedure

Begin-Heading 24 
 do HeadingProcedure
End-Heading

Begin-Procedure HeadingProcedure
 If #page-count <= 1
  Position (1,1)
 Alter-Printer Font=4 Point-Size=10    ! [SQR.INI] 4=Arial,proportional
 Print 'Produced On:' (13,594,12)
 Print $current-date (13,660) edit 'MM/DD/YYYY'
 Print-Image (21,1)
	Type=bmp-file
	Source='SHINES.bmp'
	Image-size=(125,88)
 Print 'Division of Family and Children Services' (41,284,49)
 Alter-Printer Font=4 Point-Size=12    ! [SQR.INI] 4=Arial,proportional
 Print 'DFCS Homes Development' (61,293,24) Bold 
 Alter-Printer Font=4 Point-Size=10    ! [SQR.INI] 4=Arial,proportional
 Print 'From:' (77,249,6) Bold 
 Let $StartDate=$_StartDate
 Print $StartDate (77,283,15)
 Let $EndDate=$_EndDate
 Print $EndDate (77,427,15)
 Print 'To:' (77,405,4) Bold 
 Let $Region_Header=$Region_Header
 Print $Region_Header (111,353,15)
 Let $Region_county_header=$Region_County_Header
 Print $Region_county_header (94,336,15)
 Alter-Printer Font=4 Point-Size=8    ! [SQR.INI] 4=Arial,proportional
 Print '1' (134,7,1) Foreground=(255,255,255)
 Else   ! put a non combined page header
 Print '1' (11,7,1) Foreground=(255,255,255)
 End-If
 Alter-Printer Font=901 Point-Size=10
End-Procedure
Begin-Footing 24 
 Alter-Printer Font=4 Point-Size=10    ! [SQR.INI] 4=Arial,proportional
 Page-Number (16,663) '' ' of'
 Last-Page (16,692) 
 Alter-Printer Font=901 Point-Size=10
End-Footing

